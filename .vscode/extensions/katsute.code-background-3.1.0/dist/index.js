"use strict";var _n=Object.create;var Oe=Object.defineProperty;var Qn=Object.getOwnPropertyDescriptor;var Vn=Object.getOwnPropertyNames;var $n=Object.getPrototypeOf,Xn=Object.prototype.hasOwnProperty;var re=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),Hn=(i,t)=>{for(var e in t)Oe(i,e,{get:t[e],enumerable:!0})},Gi=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Vn(t))!Xn.call(i,n)&&n!==e&&Oe(i,n,{get:()=>t[n],enumerable:!(s=Qn(t,n))||s.enumerable});return i};var Mt=(i,t,e)=>(e=i!=null?_n($n(i)):{},Gi(t||!i||!i.__esModule?Oe(e,"default",{value:i,enumerable:!0}):e,i)),Gn=i=>Gi(Oe({},"__esModule",{value:!0}),i);var hi=re((ra,Ki)=>{var g={child:require("child_process"),crypto:require("crypto"),fs:require("fs"),os:require("os"),path:require("path"),process,util:require("util")};function Zn(i,t){var e=g.process.platform;if(e==="darwin")return Kn(i,t);if(e==="linux")return Yn(i,t);if(e==="win32")return or(i,t);t(new Error("Platform not yet supported."))}function G(i){if(typeof i!="string")throw new Error("Expected a string.");return i.replace(/"/g,'\\"')}function qn(){if(arguments.length<1||arguments.length>3)throw new Error("Wrong number of arguments.");var i=arguments[0],t={},e=function(){};if(typeof i!="string")throw new Error("Command should be a string.");if(arguments.length===2)if(g.util.isObject(arguments[1]))t=arguments[1];else if(g.util.isFunction(arguments[1]))e=arguments[1];else throw new Error("Expected options or callback.");else if(arguments.length===3){if(g.util.isObject(arguments[1]))t=arguments[1];else throw new Error("Expected options to be an object.");if(g.util.isFunction(arguments[2]))e=arguments[2];else throw new Error("Expected callback to be a function.")}if(/^sudo/i.test(i))return e(new Error('Command should not be prefixed with "sudo".'));if(typeof t.name>"u"){var s=g.process.title;if(Zi(s))t.name=s;else return e(new Error("process.title cannot be used as a valid name."))}else if(!Zi(t.name)){var n="";return n+="options.name must be alphanumeric only ",n+="(spaces are allowed) and <= 70 characters.",e(new Error(n))}if(typeof t.icns<"u"){if(typeof t.icns!="string")return e(new Error("options.icns must be a string if provided."));if(t.icns.trim().length===0)return e(new Error("options.icns must not be empty if provided."))}if(typeof t.env<"u"){if(typeof t.env!="object")return e(new Error("options.env must be an object if provided."));if(Object.keys(t.env).length===0)return e(new Error("options.env must not be empty if provided."));for(var r in t.env){var o=t.env[r];if(typeof r!="string"||typeof o!="string")return e(new Error("options.env environment variables must be strings."));if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(r))return e(new Error("options.env has an invalid environment variable name: "+JSON.stringify(r)));if(/[\r\n]/.test(o))return e(new Error("options.env has an invalid environment variable value: "+JSON.stringify(o)))}}var a=g.process.platform;if(a!=="darwin"&&a!=="linux"&&a!=="win32")return e(new Error("Platform not yet supported."));var l={command:i,options:t,uuid:void 0,path:void 0};Zn(l,e)}function Yn(i,t){Jn(i,function(e,s){if(e)return t(e);var n=[];n.push('cd "'+G(g.process.cwd())+'";');for(var r in i.options.env){var o=i.options.env[r];n.push("export "+r+'="'+G(o)+'";')}n.push('"'+G(s)+'"'),/kdesudo/i.test(s)?(n.push("--comment",'"'+i.options.name+' wants to make changes. Enter your password to allow this."'),n.push("-d"),n.push("--")):/pkexec/i.test(s)&&n.push("--disable-internal-agent");var a=`SUDOPROMPT
`;n.push('/bin/bash -c "echo '+G(a.trim())+"; "+G(i.command)+'"'),n=n.join(" "),g.child.exec(n,{encoding:"utf-8",maxBuffer:fr},function(l,c,h){var u=c&&c.slice(0,a.length)===a;u&&(c=c.slice(a.length)),l&&!u&&(/No authentication agent found/.test(h)?l.message=dr:l.message=De),t(l,c,h)})})}function Jn(i,t){var e=0,s=["/usr/bin/kdesudo","/usr/bin/pkexec"];function n(){if(e===s.length)return t(new Error("Unable to find pkexec or kdesudo."));var r=s[e++];g.fs.stat(r,function(o){if(o){if(o.code==="ENOTDIR"||o.code==="ENOENT")return n();t(o)}else t(void 0,r)})}n()}function Kn(i,t){var e=g.os.tmpdir();if(!e)return t(new Error("os.tmpdir() not defined."));var s=g.process.env.USER;if(!s)return t(new Error("env['USER'] not defined."));Yi(i,function(n,r){if(n)return t(n);i.uuid=r,i.path=g.path.join(e,i.uuid,i.options.name+".app");function o(a,l,c){qi(g.path.dirname(i.path),function(h){if(a)return t(a);if(h)return t(h);t(void 0,l,c)})}tr(i,function(a,l,c){if(a)return o(a,l,c);ir(i,function(h){if(h)return o(h);nr(i,function(u,d,f){if(u)return o(u,d,f);er(i,function(b){if(b)return o(b);sr(i,function(p,k,A){if(p)return o(p,k,A);rr(i,o)})})})})})})}function tr(i,t){var e=g.path.dirname(i.path);g.fs.mkdir(e,function(s){if(s)return t(s);var n=g.path.join(e,"sudo-prompt-applet.zip");g.fs.writeFile(n,ur,"base64",function(r){if(r)return t(r);var o=[];o.push("/usr/bin/unzip"),o.push("-o"),o.push('"'+G(n)+'"'),o.push('-d "'+G(i.path)+'"'),o=o.join(" "),g.child.exec(o,{encoding:"utf-8"},t)})})}function er(i,t){var e=g.path.join(i.path,"Contents","MacOS","sudo-prompt-command"),s=[];s.push('cd "'+G(g.process.cwd())+'"');for(var n in i.options.env){var r=i.options.env[n];s.push("export "+n+'="'+G(r)+'"')}s.push(i.command),s=s.join(`
`),g.fs.writeFile(e,s,"utf-8",t)}function ir(i,t){if(!i.options.icns)return t();g.fs.readFile(i.options.icns,function(e,s){if(e)return t(e);var n=g.path.join(i.path,"Contents","Resources","applet.icns");g.fs.writeFile(n,s,t)})}function sr(i,t){var e=g.path.join(i.path,"Contents","MacOS","applet"),s={cwd:g.path.dirname(e),encoding:"utf-8"};g.child.exec("./"+g.path.basename(e),s,t)}function nr(i,t){var e=g.path.join(i.path,"Contents","Info.plist"),s=G(e),n=G("CFBundleName"),r=i.options.name+" Password Prompt";if(/'/.test(r))return t(new Error("Value should not contain single quotes."));var o=[];o.push("/usr/bin/defaults"),o.push("write"),o.push('"'+s+'"'),o.push('"'+n+'"'),o.push("'"+r+"'"),o=o.join(" "),g.child.exec(o,{encoding:"utf-8"},t)}function rr(i,t){var e=g.path.join(i.path,"Contents","MacOS");g.fs.readFile(g.path.join(e,"code"),"utf-8",function(s,n){if(s){if(s.code==="ENOENT")return t(new Error(De));t(s)}else g.fs.readFile(g.path.join(e,"stdout"),"utf-8",function(r,o){if(r)return t(r);g.fs.readFile(g.path.join(e,"stderr"),"utf-8",function(a,l){if(a)return t(a);n=parseInt(n.trim(),10),n===0?t(void 0,o,l):(a=new Error("Command failed: "+i.command+`
`+l),a.code=n,t(a,o,l))})})})}function qi(i,t){if(typeof i!="string"||!i.trim())return t(new Error("Argument path not defined."));var e=[];if(g.process.platform==="win32"){if(/"/.test(i))return t(new Error("Argument path cannot contain double-quotes."));e.push('rmdir /s /q "'+i+'"')}else e.push("/bin/rm"),e.push("-rf"),e.push('"'+G(g.path.normalize(i))+'"');e=e.join(" "),g.child.exec(e,{encoding:"utf-8"},t)}function Yi(i,t){g.crypto.randomBytes(256,function(e,s){e&&(s=Date.now()+""+Math.random());var n=g.crypto.createHash("SHA256");n.update("sudo-prompt-3"),n.update(i.options.name),n.update(i.command),n.update(s);var r=n.digest("hex").slice(-32);if(!r||typeof r!="string"||r.length!==32)return t(new Error("Expected a valid UUID."));t(void 0,r)})}function Zi(i){return!(!/^[a-z0-9 ]+$/i.test(i)||i.trim().length===0||i.length>70)}function or(i,t){var e=g.os.tmpdir();if(!e)return t(new Error("os.tmpdir() not defined."));Yi(i,function(s,n){if(s)return t(s);if(i.uuid=n,i.path=g.path.join(e,i.uuid),/"/.test(i.path))return t(new Error("instance.path cannot contain double-quotes."));i.pathElevate=g.path.join(i.path,"elevate.vbs"),i.pathExecute=g.path.join(i.path,"execute.bat"),i.pathCommand=g.path.join(i.path,"command.bat"),i.pathStdout=g.path.join(i.path,"stdout"),i.pathStderr=g.path.join(i.path,"stderr"),i.pathStatus=g.path.join(i.path,"status"),g.fs.mkdir(i.path,function(r){if(r)return t(r);function o(a,l,c){qi(i.path,function(h){if(a)return t(a);if(h)return t(h);t(void 0,l,c)})}hr(i,function(a){if(a)return o(a);cr(i,function(l){if(l)return o(l);ar(i,function(c,h,u){if(c)return o(c,h,u);Ji(i,function(d){if(d)return o(d);lr(i,o)})})})})})})}function ar(i,t){var e=[];e.push("powershell.exe"),e.push("Start-Process"),e.push("-FilePath"),e.push(`"'`+i.pathExecute.replace(/'/g,"`'")+`'"`),e.push("-WindowStyle hidden"),e.push("-Verb runAs"),e=e.join(" ");var s=g.child.exec(e,{encoding:"utf-8"},function(n,r,o){if(n)return t(new Error(De),r,o);t()});s.stdin.end()}function lr(i,t){g.fs.readFile(i.pathStatus,"utf-8",function(e,s){if(e)return t(e);g.fs.readFile(i.pathStdout,"utf-8",function(n,r){if(n)return t(n);g.fs.readFile(i.pathStderr,"utf-8",function(o,a){if(o)return t(o);s=parseInt(s.trim(),10),s===0?t(void 0,r,a):(o=new Error("Command failed: "+i.command+`\r
`+a),o.code=s,t(o,r,a))})})})}function Ji(i,t){g.fs.stat(i.pathStatus,function(e,s){e&&e.code==="ENOENT"||s.size<2?setTimeout(function(){g.fs.stat(i.pathStdout,function(n){if(n)return t(new Error(De));Ji(i,t)})},1e3):e?t(e):t()})}function cr(i,t){var e=g.process.cwd();if(/"/.test(e))return t(new Error("process.cwd() cannot contain double-quotes."));var s=[];s.push("@echo off"),s.push("chcp 65001>nul"),s.push('cd /d "'+e+'"');for(var n in i.options.env){var r=i.options.env[n];s.push("set "+n+"="+r.replace(/([<>\\|&^])/g,"^$1"))}s.push(i.command),s=s.join(`\r
`),g.fs.writeFile(i.pathCommand,s,"utf-8",t)}function hr(i,t){var e=[];e.push("@echo off"),e.push('call "'+i.pathCommand+'" > "'+i.pathStdout+'" 2> "'+i.pathStderr+'"'),e.push('(echo %ERRORLEVEL%) > "'+i.pathStatus+'"'),e=e.join(`\r
`),g.fs.writeFile(i.pathExecute,e,"utf-8",t)}Ki.exports.exec=qn;var ur="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",De="User did not grant permission.",dr="No polkit authentication agent found.",fr=134217728});var ns=re((pa,mr)=>{mr.exports={name:"code-background",displayName:"Background",description:"The most advanced background image extension for VSCode",icon:"assets/icon-sm.png",galleryBanner:{color:"#0098FF",theme:"dark"},publisher:"Katsute",version:"3.1.0",private:!0,engines:{vscode:"^1.96.0"},categories:["Other"],keywords:["bg","bk","background","cover","theme","image","gif"],activationEvents:["onStartupFinished"],extensionKind:["ui"],contributes:{commands:[{command:"background.install",title:"Install",category:"Background"},{command:"background.uninstall",title:"Uninstall",category:"Background"},{command:"background.reload",title:"Reload",category:"Background"},{command:"background.config",title:"Configuration",category:"Background"},{command:"background.changelog",title:"Changelog",category:"Background"},{command:"background.help",title:"Help",category:"Background"}],configuration:{title:"Background",order:0,properties:{"background.windowBackgrounds":{markdownDescription:"The list of files, globs, or URLs to pull background images from.\n\n* Use only `/` for directories, `\\` is reserved for escape characters.\n\n* Image URLs must be served over HTTPS.",type:"array",order:0,default:[],items:{type:"string"}},"background.editorBackgrounds":{markdownDescription:"The list of files, globs, or URLs to pull background images from.\n\n* Use only `/` for directories, `\\` is reserved for escape characters.\n\n* Image URLs must be served over HTTPS.",type:"array",order:1,default:[],items:{type:"string"}},"background.sidebarBackgrounds":{markdownDescription:"The list of files, globs, or URLs to pull background images from.\n\n* Use only `/` for directories, `\\` is reserved for escape characters.\n\n* Image URLs must be served over HTTPS.",type:"array",order:2,default:[],items:{type:"string"}},"background.panelBackgrounds":{markdownDescription:"The list of files, globs, or URLs to pull background images from.\n\n* Use only `/` for directories, `\\` is reserved for escape characters.\n\n* Image URLs must be served over HTTPS.",type:"array",order:3,default:[],items:{type:"string"}},"background.backgroundAlignment":{markdownDescription:"The background image alignment.",type:"array",order:4,default:["Center Center","Center Center","Center Center","Center Center"],minItems:4,maxItems:4,items:{type:"string",enum:["Top Left","Top Center","Top Right","Center Left","Center Center","Center Right","Bottom Left","Bottom Center","Bottom Right","Manual"]}},"background.backgroundAlignmentValue":{markdownDescription:"If `#background.backgroundAlignment#` is set to `Manual`, this is the literal value for the `background-position` css property.",type:"array",order:5,default:["50%","50%","50%","50%"],minItems:4,maxItems:4,items:{type:"string",pattern:"^[\\w.% +-]*$"}},"background.backgroundBlur":{markdownDescription:"The background image blur amount in css units.",type:"array",order:6,default:["0","0","0","0"],minItems:4,maxItems:4,items:{type:"string",pattern:"^[\\w.% +-]*$"}},"background.backgroundOpacity":{markdownDescription:"The background opacity, make sure this number is not to high, otherwise you may not be able to see the UI and revert this change.\n\n`1` is fully visible and `0` is invisible. If `#background.useInvertedOpacity#` is true, this logic is inverted.",type:"array",order:7,default:[.1,.1,.1,.1],minItems:4,maxItems:4,items:{type:"number",minimum:0,maximum:1}},"background.backgroundRepeat":{markdownDescription:"The background image repeat.",type:"array",order:8,default:["No Repeat","No Repeat","No Repeat","No Repeat"],minItems:4,maxItems:4,items:{type:"string",enum:["No Repeat","Repeat","Repeat X","Repeat Y","Repeat Space","Repeat Round"],enumDescriptions:["Do not repeat","Repeat X/Y","Repeat X","Repeat Y","Repeat with even spacing to fill the screen","Repeat and stretch images to fill the screen"]}},"background.backgroundSize":{markdownDescription:"The background image size.",type:"array",order:9,default:["Cover","Cover","Cover","Cover"],minItems:4,maxItems:4,items:{type:"string",enum:["Auto","Contain","Cover","Manual"],enumDescriptions:["Original image size","Fit image to the screen","Stretch image to fill the screen","Manual size"]}},"background.backgroundSizeValue":{markdownDescription:"If `#background.windowBackgroundSize#` is set to `Manual`, this is the literal value for the `background-size` css property.",type:"array",order:10,default:["100%","100%","100%","100%"],minItems:4,maxItems:4,items:{type:"string",pattern:"^[\\w.% +-]*$"}},"background.backgroundChangeTime":{markdownDescription:"How long in seconds before the background should automatically change.\n\nSet to `0` to always use the same image.",type:"array",order:11,default:[0,0,0,0],minItems:4,maxItems:4,items:{type:"number",minimum:0}},"background.autoInstall":{markdownDescription:`Automatically installs backgrounds and reloads the window on startup if changes are detected or VSCode updates.

This option is disabled when you run the uninstall command.`,order:12,type:"boolean",default:!1},"background.renderContentAboveBackground":{markdownDescription:"Render content like images, PDFs, and markdown previews above the background.",order:13,type:"boolean",default:!1},"background.useInvertedOpacity":{markdownDescription:"Use an inverted opacity, so 0 is fully visible and 1 is invisible.",order:14,type:"boolean",default:!1},"background.smoothImageRendering":{markdownDescription:"Use smooth image rendering rather than pixelated rendering when resizing images.",order:15,type:"boolean",default:!1},"background.settingScope":{markdownDescription:"Where to save and load background settings.\n\nThis does not automatically update the background on workspace change, you need to also turn on `#background.autoInstall#`.",order:16,type:"string",enum:["Global","Workspace"],default:"Global"},"background.CSS":{markdownDescription:"Apply raw CSS to VSCode.",order:17,type:"string",editPresentation:"multilineText",default:""}}}},main:"dist/index.js",scripts:{"// -- dev -- //":"",clean:"rimraf --glob dist & rimraf --glob code-background-*.vsix",prune:"npm prune && npm i --package-lock --ignore-scripts",update:"npm update -D && npm i --package-lock --ignore-scripts && npm run prune","// -- build -- //":"","vscode:prepublish":"npm run prepare","build:esbuild":"esbuild src/extension.ts --bundle --outfile=dist/index.js --external:vscode --format=cjs --platform=node --minify --legal-comments=none --metafile=meta.json","build:post":"node build.js",build:"tsc --noEmit && npm run build:esbuild && npm run build:post",prepare:"npm run clean && npm run build","// -- deploy -- //":"",package:"vsce package"},repository:{type:"git",url:"git+https://github.com/KatsuteDev/Background.git"},author:"Katsute",license:"GPL-2.0-only",bugs:{url:"https://github.com/KatsuteDev/Background/issues"},homepage:"https://github.com/KatsuteDev/Background#readme",devDependencies:{"@types/node":"22.10.2","@types/tmp":"0.2.6","@types/vscode":"1.96.0","@vscode/sudo-prompt":"9.3.1","@vscode/test-electron":"2.4.1","@vscode/vsce":"3.2.1",esbuild:"0.24.2",glob:"11.0.0",rimraf:"6.0.1",tmp:"0.2.3",typescript:"5.7.2"}}});var us=re((xa,hs)=>{"use strict";hs.exports=ls;function ls(i,t,e){i instanceof RegExp&&(i=as(i,e)),t instanceof RegExp&&(t=as(t,e));var s=cs(i,t,e);return s&&{start:s[0],end:s[1],pre:e.slice(0,s[0]),body:e.slice(s[0]+i.length,s[1]),post:e.slice(s[1]+t.length)}}function as(i,t){var e=t.match(i);return e?e[0]:null}ls.range=cs;function cs(i,t,e){var s,n,r,o,a,l=e.indexOf(i),c=e.indexOf(t,l+1),h=l;if(l>=0&&c>0){if(i===t)return[l,c];for(s=[],r=e.length;h>=0&&!a;)h==l?(s.push(h),l=e.indexOf(i,h+1)):s.length==1?a=[s.pop(),c]:(n=s.pop(),n<r&&(r=n,o=c),c=e.indexOf(t,h+1)),h=l<c&&l>=0?l:c;s.length&&(a=[r,o])}return a}});var ws=re((Ca,bs)=>{var ds=us();bs.exports=wr;var fs="\0SLASH"+Math.random()+"\0",ps="\0OPEN"+Math.random()+"\0",fi="\0CLOSE"+Math.random()+"\0",ms="\0COMMA"+Math.random()+"\0",gs="\0PERIOD"+Math.random()+"\0";function di(i){return parseInt(i,10)==i?parseInt(i,10):i.charCodeAt(0)}function Ar(i){return i.split("\\\\").join(fs).split("\\{").join(ps).split("\\}").join(fi).split("\\,").join(ms).split("\\.").join(gs)}function br(i){return i.split(fs).join("\\").split(ps).join("{").split(fi).join("}").split(ms).join(",").split(gs).join(".")}function As(i){if(!i)return[""];var t=[],e=ds("{","}",i);if(!e)return i.split(",");var s=e.pre,n=e.body,r=e.post,o=s.split(",");o[o.length-1]+="{"+n+"}";var a=As(r);return r.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),t.push.apply(t,o),t}function wr(i){return i?(i.substr(0,2)==="{}"&&(i="\\{\\}"+i.substr(2)),ae(Ar(i),!0).map(br)):[]}function kr(i){return"{"+i+"}"}function yr(i){return/^-?0\d/.test(i)}function vr(i,t){return i<=t}function Sr(i,t){return i>=t}function ae(i,t){var e=[],s=ds("{","}",i);if(!s)return[i];var n=s.pre,r=s.post.length?ae(s.post,!1):[""];if(/\$$/.test(s.pre))for(var o=0;o<r.length;o++){var a=n+"{"+s.body+"}"+r[o];e.push(a)}else{var l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),h=l||c,u=s.body.indexOf(",")>=0;if(!h&&!u)return s.post.match(/,.*\}/)?(i=s.pre+"{"+s.body+fi+s.post,ae(i)):[i];var d;if(h)d=s.body.split(/\.\./);else if(d=As(s.body),d.length===1&&(d=ae(d[0],!1).map(kr),d.length===1))return r.map(function(Re){return s.pre+d[0]+Re});var f;if(h){var b=di(d[0]),p=di(d[1]),k=Math.max(d[0].length,d[1].length),A=d.length==3?Math.abs(di(d[2])):1,S=vr,v=p<b;v&&(A*=-1,S=Sr);var y=d.some(yr);f=[];for(var x=b;S(x,p);x+=A){var R;if(c)R=String.fromCharCode(x),R==="\\"&&(R="");else if(R=String(x),y){var nt=k-R.length;if(nt>0){var Ot=new Array(nt+1).join("0");x<0?R="-"+Ot+R.slice(1):R=Ot+R}}f.push(R)}}else{f=[];for(var rt=0;rt<d.length;rt++)f.push.apply(f,ae(d[rt],!1))}for(var rt=0;rt<f.length;rt++)for(var o=0;o<r.length;o++){var a=n+f[rt]+r[o];(!t||h||a)&&e.push(a)}}return e}});var Un=re((oh,Et)=>{var I=require("fs"),Qi=require("os"),H=require("path"),yn=require("crypto"),gt={fs:I.constants,os:Qi.constants},vn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",En=/XXXXXX/,Lo=3,xn=(gt.O_CREAT||gt.fs.O_CREAT)|(gt.O_EXCL||gt.fs.O_EXCL)|(gt.O_RDWR||gt.fs.O_RDWR),zo=Qi.platform()==="win32",Wo=gt.EBADF||gt.os.errno.EBADF,jo=gt.ENOENT||gt.os.errno.ENOENT,Cn=448,Bn=384,_o="exit",ee=[],Tn=I.rmdirSync.bind(I),In=!1;function Qo(i,t){return I.rm(i,{recursive:!0},t)}function Rn(i){return I.rmSync(i,{recursive:!0})}function Vi(i,t){let e=ie(i,t),s=e[0],n=e[1];try{Pn(s)}catch(o){return n(o)}let r=s.tries;(function o(){try{let a=Dn(s);I.stat(a,function(l){if(!l)return r-- >0?o():n(new Error("Could not get a unique tmp filename, max tries reached "+a));n(null,a)})}catch(a){n(a)}})()}function $i(i){let t=ie(i),e=t[0];Pn(e);let s=e.tries;do{let n=Dn(e);try{I.statSync(n)}catch{return n}}while(s-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function Vo(i,t){let e=ie(i,t),s=e[0],n=e[1];Vi(s,function(o,a){if(o)return n(o);I.open(a,xn,s.mode||Bn,function(c,h){if(c)return n(c);if(s.discardDescriptor)return I.close(h,function(d){return n(d,a,void 0,Wi(a,-1,s,!1))});{let u=s.discardDescriptor||s.detachDescriptor;n(null,a,h,Wi(a,u?-1:h,s,!1))}})})}function $o(i){let t=ie(i),e=t[0],s=e.discardDescriptor||e.detachDescriptor,n=$i(e);var r=I.openSync(n,xn,e.mode||Bn);return e.discardDescriptor&&(I.closeSync(r),r=void 0),{name:n,fd:r,removeCallback:Wi(n,s?-1:r,e,!0)}}function Xo(i,t){let e=ie(i,t),s=e[0],n=e[1];Vi(s,function(o,a){if(o)return n(o);I.mkdir(a,s.mode||Cn,function(c){if(c)return n(c);n(null,a,On(a,s,!1))})})}function Ho(i){let t=ie(i),e=t[0],s=$i(e);return I.mkdirSync(s,e.mode||Cn),{name:s,removeCallback:On(s,e,!0)}}function Go(i,t){let e=function(s){if(s&&!_i(s))return t(s);t()};0<=i[0]?I.close(i[0],function(){I.unlink(i[1],e)}):I.unlink(i[1],e)}function Zo(i){let t=null;try{0<=i[0]&&I.closeSync(i[0])}catch(e){if(!Jo(e)&&!_i(e))throw e}finally{try{I.unlinkSync(i[1])}catch(e){_i(e)||(t=e)}}if(t!==null)throw t}function Wi(i,t,e,s){let n=ai(Zo,[t,i],s),r=ai(Go,[t,i],s,n);return e.keep||ee.unshift(n),s?n:r}function On(i,t,e){let s=t.unsafeCleanup?Qo:I.rmdir.bind(I),n=t.unsafeCleanup?Rn:Tn,r=ai(n,i,e),o=ai(s,i,e,r);return t.keep||ee.unshift(r),e?r:o}function ai(i,t,e,s){let n=!1;return function r(o){if(!n){let a=s||r,l=ee.indexOf(a);return l>=0&&ee.splice(l,1),n=!0,e||i===Tn||i===Rn?i(t):i(t,o||function(){})}}}function qo(){if(In)for(;ee.length;)try{ee[0]()}catch{}}function Sn(i){let t=[],e=null;try{e=yn.randomBytes(i)}catch{e=yn.pseudoRandomBytes(i)}for(var s=0;s<i;s++)t.push(vn[e[s]%vn.length]);return t.join("")}function Yo(i){return i===null||V(i)||!i.trim()}function V(i){return typeof i>"u"}function ie(i,t){if(typeof i=="function")return[{},i];if(V(i))return[{},t];let e={};for(let s of Object.getOwnPropertyNames(i))e[s]=i[s];return[e,t]}function Dn(i){let t=i.tmpdir;if(!V(i.name))return H.join(t,i.dir,i.name);if(!V(i.template))return H.join(t,i.dir,i.template).replace(En,Sn(6));let e=[i.prefix?i.prefix:"tmp","-",process.pid,"-",Sn(12),i.postfix?"-"+i.postfix:""].join("");return H.join(t,i.dir,e)}function Pn(i){i.tmpdir=Nn(i);let t=i.tmpdir;if(V(i.name)||zi(i.name,"name",t),V(i.dir)||zi(i.dir,"dir",t),!V(i.template)&&(zi(i.template,"template",t),!i.template.match(En)))throw new Error(`Invalid template, found "${i.template}".`);if(!V(i.tries)&&isNaN(i.tries)||i.tries<0)throw new Error(`Invalid tries, found "${i.tries}".`);i.tries=V(i.name)?i.tries||Lo:1,i.keep=!!i.keep,i.detachDescriptor=!!i.detachDescriptor,i.discardDescriptor=!!i.discardDescriptor,i.unsafeCleanup=!!i.unsafeCleanup,i.dir=V(i.dir)?"":H.relative(t,ji(i.dir,t)),i.template=V(i.template)?void 0:H.relative(t,ji(i.template,t)),i.template=Yo(i.template)?void 0:H.relative(i.dir,i.template),i.name=V(i.name)?void 0:i.name,i.prefix=V(i.prefix)?"":i.prefix,i.postfix=V(i.postfix)?"":i.postfix}function ji(i,t){return i.startsWith(t)?H.resolve(i):H.resolve(H.join(t,i))}function zi(i,t,e){if(t==="name"){if(H.isAbsolute(i))throw new Error(`${t} option must not contain an absolute path, found "${i}".`);let s=H.basename(i);if(s===".."||s==="."||s!==i)throw new Error(`${t} option must not contain a path, found "${i}".`)}else{if(H.isAbsolute(i)&&!i.startsWith(e))throw new Error(`${t} option must be relative to "${e}", found "${i}".`);let s=ji(i,e);if(!s.startsWith(e))throw new Error(`${t} option must be relative to "${e}", found "${s}".`)}}function Jo(i){return Fn(i,-Wo,"EBADF")}function _i(i){return Fn(i,-jo,"ENOENT")}function Fn(i,t,e){return zo?i.code===e:i.code===e&&i.errno===t}function Ko(){In=!0}function Nn(i){return H.resolve(i&&i.tmpdir||Qi.tmpdir())}process.addListener(_o,qo);Object.defineProperty(Et.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return Nn()}});Et.exports.dir=Xo;Et.exports.dirSync=Ho;Et.exports.file=Vo;Et.exports.fileSync=$o;Et.exports.tmpName=Vi;Et.exports.tmpNameSync=$i;Et.exports.setGracefulCleanup=Ko});var sa={};Hn(sa,{activate:()=>ia,installDelay:()=>Te,setActive:()=>se,statusbar:()=>ci});module.exports=Gn(sa);var ne=require("path"),Ie=require("os"),Wn=Mt(hi()),Rt=require("fs"),E=require("vscode");var ts=require("process"),es=require("crypto"),is=require("fs"),pr=ts.platform==="win32",Pe=i=>i.map(t=>pr?((0,is.existsSync)(t[1])?"":`echo "NUL" > "${t[1]}" && `)+`xcopy /r /y "${t[0]}" "${t[1]}"`:`cp -f '${t[0]}' '${t[1]}'`).join(" && "),ss=i=>(0,es.createHash)("sha256").update(i).digest("base64").replace(/=+$/gm,"");var Dt=require("vscode"),Pt=()=>Dt.commands.executeCommand("workbench.action.reloadWindow"),Z=(i={})=>{i.handle&&Dt.window.showInputBox(i).then(t=>{t!==void 0&&new Promise(()=>i.handle(t))})},w=(i,t)=>({...i,description:((i.description??"")+(i.label===t?" (selected)":"")).trim()}),q=(i,t={},e,s)=>{let n=Dt.window.createQuickPick();n.items=[...e?[w({alwaysShow:!0,label:"$(arrow-left) Back",handle:e}),j()]:[],...i];for(let[r,o]of Object.entries(t))n[r]=o;n.onDidAccept(()=>{let r=n.selectedItems[0];r?.handle&&new Promise(()=>r.handle(r))}),s!==void 0&&(n.activeItems=[n.items[s+(e?2:0)]]),n.show()},j=()=>({label:"",kind:Dt.QuickPickItemKind.Separator});var Li=require("vscode");var Kt=require("vscode");var N=(i,t)=>Math.round((i+Number.EPSILON)*Math.pow(10,t))/Math.pow(10,t);var Y=require("vscode");var ui=ns(),At=i=>ui.contributes.configuration.properties[`background.${i}`];var rs=i=>i.replace(/\r?\n/gm," ").replace(/"/gm,"'").replace(/\\+$/gm,""),Fe=i=>i.replace(/[^\w.% +-]/gmi,""),gr=/[^\w.% +-]/gm,bt=i=>!i.match(gr);var os=i=>({window:0,editor:1,sidebar:2,panel:3})[i],dt=i=>Y.workspace.getConfiguration("background",i),Lt=()=>dt().get("settingScope")==="Workspace"&&Y.workspace.workspaceFolders?Y.ConfigurationTarget.Workspace:Y.ConfigurationTarget.Global,oe=()=>Y.window.showWarningMessage("Background has been modified, a reinstall is required to see changes.","Install and Reload","Ignore").then(i=>{i==="Install and Reload"&&Y.commands.executeCommand("background.install")}),m=(i,t)=>{let e=dt().inspect(i),{ui:s,scope:n,includeDefault:r=!0}=t??{},o={workspace:e.workspaceValue,global:e.globalValue,default:e.defaultValue};i==="backgroundOpacity"&&m("useInvertedOpacity")&&(o.default=[.9,.9,.9,.9]);let a;if(a=Array.isArray(o.default)&&(n==="workspace"||Lt()===Y.ConfigurationTarget.Workspace)?o.workspace:o.global,a??=r?o.default:void 0,Array.isArray(o.default)&&Array.isArray(a)){if(o.default.length===0)return a;if(s)return a[os(s)]}return a},C=(i,t)=>{let e=m(i,{ui:t}),s=At(i);switch(i){case"backgroundAlignment":switch(e){case s.items.enum[0]:return"left top";case s.items.enum[1]:return"center top";case s.items.enum[2]:return"right top";case s.items.enum[3]:return"left center";case s.items.enum[4]:return"center center";case s.items.enum[5]:return"right center";case s.items.enum[6]:return"left bottom";case s.items.enum[7]:return"center bottom";case s.items.enum[8]:return"right bottom";case s.items.enum[9]:return Fe(m("backgroundAlignmentValue",{ui:t}))}case"backgroundBlur":return Fe(e);case"backgroundOpacity":return isNaN(+e)?s.default[0]:N(+e,2);case"backgroundRepeat":switch(e){case s.items.enum[0]:return"no-repeat";case s.items.enum[1]:return"repeat";case s.items.enum[2]:return"repeat-x";case s.items.enum[3]:return"repeat-y";case s.items.enum[4]:return"space";case s.items.enum[5]:return"round"}case"backgroundSize":switch(e){case s.items.enum[0]:return"auto";case s.items.enum[1]:return"contain";case s.items.enum[2]:return"cover";case s.items.enum[3]:return Fe(m("backgroundSizeValue",{ui:t}))}default:return"null"}},B=async(i,t,e,s=!1)=>{let n=!1;if(!e)n=m(i)!==t,await dt().update(i,t,Array.isArray(t)?Lt():Y.ConfigurationTarget.Global);else{let r=m(i);for(let a=r.length;a<4;a++)r.push(At(i).default[0]);let o=os(e);n=r[o]!==t,r[o]=t,await dt().update(i,r,Lt())}s===!1&&n&&oe()},zt=async(i,t,e)=>{t.label&&await B(i,t.label,e)};var cn=require("path");var Bs=Mt(ws(),1);var le=i=>{if(typeof i!="string")throw new TypeError("invalid pattern");if(i.length>65536)throw new TypeError("pattern is too long")};var Er={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},ce=i=>i.replace(/[[\]\\-]/g,"\\$&"),xr=i=>i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),ks=i=>i.join(""),ys=(i,t)=>{let e=t;if(i.charAt(e)!=="[")throw new Error("not in a brace expression");let s=[],n=[],r=e+1,o=!1,a=!1,l=!1,c=!1,h=e,u="";t:for(;r<i.length;){let p=i.charAt(r);if((p==="!"||p==="^")&&r===e+1){c=!0,r++;continue}if(p==="]"&&o&&!l){h=r+1;break}if(o=!0,p==="\\"&&!l){l=!0,r++;continue}if(p==="["&&!l){for(let[k,[A,S,v]]of Object.entries(Er))if(i.startsWith(k,r)){if(u)return["$.",!1,i.length-e,!0];r+=k.length,v?n.push(A):s.push(A),a=a||S;continue t}}if(l=!1,u){p>u?s.push(ce(u)+"-"+ce(p)):p===u&&s.push(ce(p)),u="",r++;continue}if(i.startsWith("-]",r+1)){s.push(ce(p+"-")),r+=2;continue}if(i.startsWith("-",r+1)){u=p,r+=2;continue}s.push(ce(p)),r++}if(h<r)return["",!1,0,!1];if(!s.length&&!n.length)return["$.",!1,i.length-e,!0];if(n.length===0&&s.length===1&&/^\\?.$/.test(s[0])&&!c){let p=s[0].length===2?s[0].slice(-1):s[0];return[xr(p),!1,h-e,!1]}let d="["+(c?"^":"")+ks(s)+"]",f="["+(c?"":"^")+ks(n)+"]";return[s.length&&n.length?"("+d+"|"+f+")":s.length?d:f,a,h-e,!0]};var ot=(i,{windowsPathsNoEscape:t=!1}={})=>t?i.replace(/\[([^\/\\])\]/g,"$1"):i.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1");var Cr=new Set(["!","?","+","*","@"]),vs=i=>Cr.has(i),Br="(?!(?:^|/)\\.\\.?(?:$|/))",Ne="(?!\\.)",Tr=new Set(["[","."]),Ir=new Set(["..","."]),Rr=new Set("().*{}+?[]^$\\!"),Or=i=>i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),pi="[^/]",Ss=pi+"*?",Es=pi+"+?",Wt=class i{type;#t;#e;#r=!1;#s=[];#o;#k;#c;#u=!1;#a;#l;#n=!1;constructor(t,e,s={}){this.type=t,t&&(this.#e=!0),this.#o=e,this.#t=this.#o?this.#o.#t:this,this.#a=this.#t===this?s:this.#t.#a,this.#c=this.#t===this?[]:this.#t.#c,t==="!"&&!this.#t.#u&&this.#c.push(this),this.#k=this.#o?this.#o.#s.length:0}get hasMagic(){if(this.#e!==void 0)return this.#e;for(let t of this.#s)if(typeof t!="string"&&(t.type||t.hasMagic))return this.#e=!0;return this.#e}toString(){return this.#l!==void 0?this.#l:this.type?this.#l=this.type+"("+this.#s.map(t=>String(t)).join("|")+")":this.#l=this.#s.map(t=>String(t)).join("")}#g(){if(this!==this.#t)throw new Error("should only call on root");if(this.#u)return this;this.toString(),this.#u=!0;let t;for(;t=this.#c.pop();){if(t.type!=="!")continue;let e=t,s=e.#o;for(;s;){for(let n=e.#k+1;!s.type&&n<s.#s.length;n++)for(let r of t.#s){if(typeof r=="string")throw new Error("string part in extglob AST??");r.copyIn(s.#s[n])}e=s,s=e.#o}}return this}push(...t){for(let e of t)if(e!==""){if(typeof e!="string"&&!(e instanceof i&&e.#o===this))throw new Error("invalid part: "+e);this.#s.push(e)}}toJSON(){let t=this.type===null?this.#s.slice().map(e=>typeof e=="string"?e:e.toJSON()):[this.type,...this.#s.map(e=>e.toJSON())];return this.isStart()&&!this.type&&t.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#u&&this.#o?.type==="!")&&t.push({}),t}isStart(){if(this.#t===this)return!0;if(!this.#o?.isStart())return!1;if(this.#k===0)return!0;let t=this.#o;for(let e=0;e<this.#k;e++){let s=t.#s[e];if(!(s instanceof i&&s.type==="!"))return!1}return!0}isEnd(){if(this.#t===this||this.#o?.type==="!")return!0;if(!this.#o?.isEnd())return!1;if(!this.type)return this.#o?.isEnd();let t=this.#o?this.#o.#s.length:0;return this.#k===t-1}copyIn(t){typeof t=="string"?this.push(t):this.push(t.clone(this))}clone(t){let e=new i(this.type,t);for(let s of this.#s)e.copyIn(s);return e}static#A(t,e,s,n){let r=!1,o=!1,a=-1,l=!1;if(e.type===null){let f=s,b="";for(;f<t.length;){let p=t.charAt(f++);if(r||p==="\\"){r=!r,b+=p;continue}if(o){f===a+1?(p==="^"||p==="!")&&(l=!0):p==="]"&&!(f===a+2&&l)&&(o=!1),b+=p;continue}else if(p==="["){o=!0,a=f,l=!1,b+=p;continue}if(!n.noext&&vs(p)&&t.charAt(f)==="("){e.push(b),b="";let k=new i(p,e);f=i.#A(t,k,f,n),e.push(k);continue}b+=p}return e.push(b),f}let c=s+1,h=new i(null,e),u=[],d="";for(;c<t.length;){let f=t.charAt(c++);if(r||f==="\\"){r=!r,d+=f;continue}if(o){c===a+1?(f==="^"||f==="!")&&(l=!0):f==="]"&&!(c===a+2&&l)&&(o=!1),d+=f;continue}else if(f==="["){o=!0,a=c,l=!1,d+=f;continue}if(vs(f)&&t.charAt(c)==="("){h.push(d),d="";let b=new i(f,h);h.push(b),c=i.#A(t,b,c,n);continue}if(f==="|"){h.push(d),d="",u.push(h),h=new i(null,e);continue}if(f===")")return d===""&&e.#s.length===0&&(e.#n=!0),h.push(d),d="",e.push(...u,h),c;d+=f}return e.type=null,e.#e=void 0,e.#s=[t.substring(s-1)],c}static fromGlob(t,e={}){let s=new i(null,void 0,e);return i.#A(t,s,0,e),s}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();let t=this.toString(),[e,s,n,r]=this.toRegExpSource();if(!(n||this.#e||this.#a.nocase&&!this.#a.nocaseMagicOnly&&t.toUpperCase()!==t.toLowerCase()))return s;let a=(this.#a.nocase?"i":"")+(r?"u":"");return Object.assign(new RegExp(`^${e}$`,a),{_src:e,_glob:t})}get options(){return this.#a}toRegExpSource(t){let e=t??!!this.#a.dot;if(this.#t===this&&this.#g(),!this.type){let l=this.isStart()&&this.isEnd(),c=this.#s.map(f=>{let[b,p,k,A]=typeof f=="string"?i.#d(f,this.#e,l):f.toRegExpSource(t);return this.#e=this.#e||k,this.#r=this.#r||A,b}).join(""),h="";if(this.isStart()&&typeof this.#s[0]=="string"&&!(this.#s.length===1&&Ir.has(this.#s[0]))){let b=Tr,p=e&&b.has(c.charAt(0))||c.startsWith("\\.")&&b.has(c.charAt(2))||c.startsWith("\\.\\.")&&b.has(c.charAt(4)),k=!e&&!t&&b.has(c.charAt(0));h=p?Br:k?Ne:""}let u="";return this.isEnd()&&this.#t.#u&&this.#o?.type==="!"&&(u="(?:$|\\/)"),[h+c+u,ot(c),this.#e=!!this.#e,this.#r]}let s=this.type==="*"||this.type==="+",n=this.type==="!"?"(?:(?!(?:":"(?:",r=this.#f(e);if(this.isStart()&&this.isEnd()&&!r&&this.type!=="!"){let l=this.toString();return this.#s=[l],this.type=null,this.#e=void 0,[l,ot(this.toString()),!1,!1]}let o=!s||t||e||!Ne?"":this.#f(!0);o===r&&(o=""),o&&(r=`(?:${r})(?:${o})*?`);let a="";if(this.type==="!"&&this.#n)a=(this.isStart()&&!e?Ne:"")+Es;else{let l=this.type==="!"?"))"+(this.isStart()&&!e&&!t?Ne:"")+Ss+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&o?")":this.type==="*"&&o?")?":`)${this.type}`;a=n+r+l}return[a,ot(r),this.#e=!!this.#e,this.#r]}#f(t){return this.#s.map(e=>{if(typeof e=="string")throw new Error("string type in extglob ast??");let[s,n,r,o]=e.toRegExpSource(t);return this.#r=this.#r||o,s}).filter(e=>!(this.isStart()&&this.isEnd())||!!e).join("|")}static#d(t,e,s=!1){let n=!1,r="",o=!1;for(let a=0;a<t.length;a++){let l=t.charAt(a);if(n){n=!1,r+=(Rr.has(l)?"\\":"")+l;continue}if(l==="\\"){a===t.length-1?r+="\\\\":n=!0;continue}if(l==="["){let[c,h,u,d]=ys(t,a);if(u){r+=c,o=o||h,a+=u-1,e=e||d;continue}}if(l==="*"){s&&t==="*"?r+=Es:r+=Ss,e=!0;continue}if(l==="?"){r+=pi,e=!0;continue}r+=Or(l)}return[r,ot(t),!!e,o]}};var xt=(i,{windowsPathsNoEscape:t=!1}={})=>t?i.replace(/[?*()[\]]/g,"[$&]"):i.replace(/[?*()[\]\\]/g,"\\$&");var _=(i,t,e={})=>(le(t),!e.nocomment&&t.charAt(0)==="#"?!1:new $(t,e).match(i)),Dr=/^\*+([^+@!?\*\[\(]*)$/,Pr=i=>t=>!t.startsWith(".")&&t.endsWith(i),Fr=i=>t=>t.endsWith(i),Nr=i=>(i=i.toLowerCase(),t=>!t.startsWith(".")&&t.toLowerCase().endsWith(i)),Ur=i=>(i=i.toLowerCase(),t=>t.toLowerCase().endsWith(i)),Mr=/^\*+\.\*+$/,Lr=i=>!i.startsWith(".")&&i.includes("."),zr=i=>i!=="."&&i!==".."&&i.includes("."),Wr=/^\.\*+$/,jr=i=>i!=="."&&i!==".."&&i.startsWith("."),_r=/^\*+$/,Qr=i=>i.length!==0&&!i.startsWith("."),Vr=i=>i.length!==0&&i!=="."&&i!=="..",$r=/^\?+([^+@!?\*\[\(]*)?$/,Xr=([i,t=""])=>{let e=Ts([i]);return t?(t=t.toLowerCase(),s=>e(s)&&s.toLowerCase().endsWith(t)):e},Hr=([i,t=""])=>{let e=Is([i]);return t?(t=t.toLowerCase(),s=>e(s)&&s.toLowerCase().endsWith(t)):e},Gr=([i,t=""])=>{let e=Is([i]);return t?s=>e(s)&&s.endsWith(t):e},Zr=([i,t=""])=>{let e=Ts([i]);return t?s=>e(s)&&s.endsWith(t):e},Ts=([i])=>{let t=i.length;return e=>e.length===t&&!e.startsWith(".")},Is=([i])=>{let t=i.length;return e=>e.length===t&&e!=="."&&e!==".."},Rs=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",xs={win32:{sep:"\\"},posix:{sep:"/"}},qr=Rs==="win32"?xs.win32.sep:xs.posix.sep;_.sep=qr;var U=Symbol("globstar **");_.GLOBSTAR=U;var Yr="[^/]",Jr=Yr+"*?",Kr="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",to="(?:(?!(?:\\/|^)\\.).)*?",eo=(i,t={})=>e=>_(e,i,t);_.filter=eo;var J=(i,t={})=>Object.assign({},i,t),io=i=>{if(!i||typeof i!="object"||!Object.keys(i).length)return _;let t=_;return Object.assign((s,n,r={})=>t(s,n,J(i,r)),{Minimatch:class extends t.Minimatch{constructor(n,r={}){super(n,J(i,r))}static defaults(n){return t.defaults(J(i,n)).Minimatch}},AST:class extends t.AST{constructor(n,r,o={}){super(n,r,J(i,o))}static fromGlob(n,r={}){return t.AST.fromGlob(n,J(i,r))}},unescape:(s,n={})=>t.unescape(s,J(i,n)),escape:(s,n={})=>t.escape(s,J(i,n)),filter:(s,n={})=>t.filter(s,J(i,n)),defaults:s=>t.defaults(J(i,s)),makeRe:(s,n={})=>t.makeRe(s,J(i,n)),braceExpand:(s,n={})=>t.braceExpand(s,J(i,n)),match:(s,n,r={})=>t.match(s,n,J(i,r)),sep:t.sep,GLOBSTAR:U})};_.defaults=io;var Os=(i,t={})=>(le(i),t.nobrace||!/\{(?:(?!\{).)*\}/.test(i)?[i]:(0,Bs.default)(i));_.braceExpand=Os;var so=(i,t={})=>new $(i,t).makeRe();_.makeRe=so;var no=(i,t,e={})=>{let s=new $(t,e);return i=i.filter(n=>s.match(n)),s.options.nonull&&!i.length&&i.push(t),i};_.match=no;var Cs=/[?*]|[+@!]\(.*?\)|\[|\]/,ro=i=>i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),$=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(t,e={}){le(t),e=e||{},this.options=e,this.pattern=t,this.platform=e.platform||Rs,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||e.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!e.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!e.nonegate,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=e.windowsNoMagicRoot!==void 0?e.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let t of this.set)for(let e of t)if(typeof e!="string")return!0;return!1}debug(...t){}make(){let t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],e.debug&&(this.debug=(...r)=>console.error(...r)),this.debug(this.pattern,this.globSet);let s=this.globSet.map(r=>this.slashSplit(r));this.globParts=this.preprocess(s),this.debug(this.pattern,this.globParts);let n=this.globParts.map((r,o,a)=>{if(this.isWindows&&this.windowsNoMagicRoot){let l=r[0]===""&&r[1]===""&&(r[2]==="?"||!Cs.test(r[2]))&&!Cs.test(r[3]),c=/^[a-z]:/i.test(r[0]);if(l)return[...r.slice(0,4),...r.slice(4).map(h=>this.parse(h))];if(c)return[r[0],...r.slice(1).map(h=>this.parse(h))]}return r.map(l=>this.parse(l))});if(this.debug(this.pattern,n),this.set=n.filter(r=>r.indexOf(!1)===-1),this.isWindows)for(let r=0;r<this.set.length;r++){let o=this.set[r];o[0]===""&&o[1]===""&&this.globParts[r][2]==="?"&&typeof o[3]=="string"&&/^[a-z]:$/i.test(o[3])&&(o[2]="?")}this.debug(this.pattern,this.set)}preprocess(t){if(this.options.noglobstar)for(let s=0;s<t.length;s++)for(let n=0;n<t[s].length;n++)t[s][n]==="**"&&(t[s][n]="*");let{optimizationLevel:e=1}=this.options;return e>=2?(t=this.firstPhasePreProcess(t),t=this.secondPhasePreProcess(t)):e>=1?t=this.levelOneOptimize(t):t=this.adjascentGlobstarOptimize(t),t}adjascentGlobstarOptimize(t){return t.map(e=>{let s=-1;for(;(s=e.indexOf("**",s+1))!==-1;){let n=s;for(;e[n+1]==="**";)n++;n!==s&&e.splice(s,n-s)}return e})}levelOneOptimize(t){return t.map(e=>(e=e.reduce((s,n)=>{let r=s[s.length-1];return n==="**"&&r==="**"?s:n===".."&&r&&r!==".."&&r!=="."&&r!=="**"?(s.pop(),s):(s.push(n),s)},[]),e.length===0?[""]:e))}levelTwoFileOptimize(t){Array.isArray(t)||(t=this.slashSplit(t));let e=!1;do{if(e=!1,!this.preserveMultipleSlashes){for(let n=1;n<t.length-1;n++){let r=t[n];n===1&&r===""&&t[0]===""||(r==="."||r==="")&&(e=!0,t.splice(n,1),n--)}t[0]==="."&&t.length===2&&(t[1]==="."||t[1]==="")&&(e=!0,t.pop())}let s=0;for(;(s=t.indexOf("..",s+1))!==-1;){let n=t[s-1];n&&n!=="."&&n!==".."&&n!=="**"&&(e=!0,t.splice(s-1,2),s-=2)}}while(e);return t.length===0?[""]:t}firstPhasePreProcess(t){let e=!1;do{e=!1;for(let s of t){let n=-1;for(;(n=s.indexOf("**",n+1))!==-1;){let o=n;for(;s[o+1]==="**";)o++;o>n&&s.splice(n+1,o-n);let a=s[n+1],l=s[n+2],c=s[n+3];if(a!==".."||!l||l==="."||l===".."||!c||c==="."||c==="..")continue;e=!0,s.splice(n,1);let h=s.slice(0);h[n]="**",t.push(h),n--}if(!this.preserveMultipleSlashes){for(let o=1;o<s.length-1;o++){let a=s[o];o===1&&a===""&&s[0]===""||(a==="."||a==="")&&(e=!0,s.splice(o,1),o--)}s[0]==="."&&s.length===2&&(s[1]==="."||s[1]==="")&&(e=!0,s.pop())}let r=0;for(;(r=s.indexOf("..",r+1))!==-1;){let o=s[r-1];if(o&&o!=="."&&o!==".."&&o!=="**"){e=!0;let l=r===1&&s[r+1]==="**"?["."]:[];s.splice(r-1,2,...l),s.length===0&&s.push(""),r-=2}}}}while(e);return t}secondPhasePreProcess(t){for(let e=0;e<t.length-1;e++)for(let s=e+1;s<t.length;s++){let n=this.partsMatch(t[e],t[s],!this.preserveMultipleSlashes);if(n){t[e]=[],t[s]=n;break}}return t.filter(e=>e.length)}partsMatch(t,e,s=!1){let n=0,r=0,o=[],a="";for(;n<t.length&&r<e.length;)if(t[n]===e[r])o.push(a==="b"?e[r]:t[n]),n++,r++;else if(s&&t[n]==="**"&&e[r]===t[n+1])o.push(t[n]),n++;else if(s&&e[r]==="**"&&t[n]===e[r+1])o.push(e[r]),r++;else if(t[n]==="*"&&e[r]&&(this.options.dot||!e[r].startsWith("."))&&e[r]!=="**"){if(a==="b")return!1;a="a",o.push(t[n]),n++,r++}else if(e[r]==="*"&&t[n]&&(this.options.dot||!t[n].startsWith("."))&&t[n]!=="**"){if(a==="a")return!1;a="b",o.push(e[r]),n++,r++}else return!1;return t.length===e.length&&o}parseNegate(){if(this.nonegate)return;let t=this.pattern,e=!1,s=0;for(let n=0;n<t.length&&t.charAt(n)==="!";n++)e=!e,s++;s&&(this.pattern=t.slice(s)),this.negate=e}matchOne(t,e,s=!1){let n=this.options;if(this.isWindows){let p=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),k=!p&&t[0]===""&&t[1]===""&&t[2]==="?"&&/^[a-z]:$/i.test(t[3]),A=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),S=!A&&e[0]===""&&e[1]===""&&e[2]==="?"&&typeof e[3]=="string"&&/^[a-z]:$/i.test(e[3]),v=k?3:p?0:void 0,y=S?3:A?0:void 0;if(typeof v=="number"&&typeof y=="number"){let[x,R]=[t[v],e[y]];x.toLowerCase()===R.toLowerCase()&&(e[y]=x,y>v?e=e.slice(y):v>y&&(t=t.slice(v)))}}let{optimizationLevel:r=1}=this.options;r>=2&&(t=this.levelTwoFileOptimize(t)),this.debug("matchOne",this,{file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var o=0,a=0,l=t.length,c=e.length;o<l&&a<c;o++,a++){this.debug("matchOne loop");var h=e[a],u=t[o];if(this.debug(e,h,u),h===!1)return!1;if(h===U){this.debug("GLOBSTAR",[e,h,u]);var d=o,f=a+1;if(f===c){for(this.debug("** at the end");o<l;o++)if(t[o]==="."||t[o]===".."||!n.dot&&t[o].charAt(0)===".")return!1;return!0}for(;d<l;){var b=t[d];if(this.debug(`
globstar while`,t,d,e,f,b),this.matchOne(t.slice(d),e.slice(f),s))return this.debug("globstar found match!",d,l,b),!0;if(b==="."||b===".."||!n.dot&&b.charAt(0)==="."){this.debug("dot detected!",t,d,e,f);break}this.debug("globstar swallow a segment, and continue"),d++}return!!(s&&(this.debug(`
>>> no match, partial?`,t,d,e,f),d===l))}let p;if(typeof h=="string"?(p=u===h,this.debug("string match",h,u,p)):(p=h.test(u),this.debug("pattern match",h,u,p)),!p)return!1}if(o===l&&a===c)return!0;if(o===l)return s;if(a===c)return o===l-1&&t[o]==="";throw new Error("wtf?")}braceExpand(){return Os(this.pattern,this.options)}parse(t){le(t);let e=this.options;if(t==="**")return U;if(t==="")return"";let s,n=null;(s=t.match(_r))?n=e.dot?Vr:Qr:(s=t.match(Dr))?n=(e.nocase?e.dot?Ur:Nr:e.dot?Fr:Pr)(s[1]):(s=t.match($r))?n=(e.nocase?e.dot?Hr:Xr:e.dot?Gr:Zr)(s):(s=t.match(Mr))?n=e.dot?zr:Lr:(s=t.match(Wr))&&(n=jr);let r=Wt.fromGlob(t,this.options).toMMPattern();return n&&typeof r=="object"&&Reflect.defineProperty(r,"test",{value:n}),r}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let t=this.set;if(!t.length)return this.regexp=!1,this.regexp;let e=this.options,s=e.noglobstar?Jr:e.dot?Kr:to,n=new Set(e.nocase?["i"]:[]),r=t.map(l=>{let c=l.map(h=>{if(h instanceof RegExp)for(let u of h.flags.split(""))n.add(u);return typeof h=="string"?ro(h):h===U?U:h._src});return c.forEach((h,u)=>{let d=c[u+1],f=c[u-1];h!==U||f===U||(f===void 0?d!==void 0&&d!==U?c[u+1]="(?:\\/|"+s+"\\/)?"+d:c[u]=s:d===void 0?c[u-1]=f+"(?:\\/|"+s+")?":d!==U&&(c[u-1]=f+"(?:\\/|\\/"+s+"\\/)"+d,c[u+1]=U))}),c.filter(h=>h!==U).join("/")}).join("|"),[o,a]=t.length>1?["(?:",")"]:["",""];r="^"+o+r+a+"$",this.negate&&(r="^(?!"+r+").+$");try{this.regexp=new RegExp(r,[...n].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(t){return this.preserveMultipleSlashes?t.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(t)?["",...t.split(/\/+/)]:t.split(/\/+/)}match(t,e=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return t==="";if(t==="/"&&e)return!0;let s=this.options;this.isWindows&&(t=t.split("\\").join("/"));let n=this.slashSplit(t);this.debug(this.pattern,"split",n);let r=this.set;this.debug(this.pattern,"set",r);let o=n[n.length-1];if(!o)for(let a=n.length-2;!o&&a>=0;a--)o=n[a];for(let a=0;a<r.length;a++){let l=r[a],c=n;if(s.matchBase&&l.length===1&&(c=[o]),this.matchOne(c,l,e))return s.flipNegate?!0:!this.negate}return s.flipNegate?!1:this.negate}static defaults(t){return _.defaults(t).Minimatch}};_.AST=Wt;_.Minimatch=$;_.escape=xt;_.unescape=ot;var en=require("node:url");var jt=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Ps=new Set,mi=typeof process=="object"&&process?process:{},Fs=(i,t,e,s)=>{typeof mi.emitWarning=="function"?mi.emitWarning(i,t,e,s):console.error(`[${e}] ${t}: ${i}`)},Ue=globalThis.AbortController,Ds=globalThis.AbortSignal;if(typeof Ue>"u"){Ds=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(s,n){this._onabort.push(n)}},Ue=class{constructor(){t()}signal=new Ds;abort(s){if(!this.signal.aborted){this.signal.reason=s,this.signal.aborted=!0;for(let n of this.signal._onabort)n(s);this.signal.onabort?.(s)}}};let i=mi.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",t=()=>{i&&(i=!1,Fs("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}var oo=i=>!Ps.has(i),Xa=Symbol("type"),Ct=i=>i&&i===Math.floor(i)&&i>0&&isFinite(i),Ns=i=>Ct(i)?i<=Math.pow(2,8)?Uint8Array:i<=Math.pow(2,16)?Uint16Array:i<=Math.pow(2,32)?Uint32Array:i<=Number.MAX_SAFE_INTEGER?_t:null:null,_t=class extends Array{constructor(t){super(t),this.fill(0)}},gi=class i{heap;length;static#t=!1;static create(t){let e=Ns(t);if(!e)return[];i.#t=!0;let s=new i(t,e);return i.#t=!1,s}constructor(t,e){if(!i.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}},he=class i{#t;#e;#r;#s;#o;#k;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#c;#u;#a;#l;#n;#g;#A;#f;#d;#S;#m;#E;#x;#w;#y;#v;#p;static unsafeExposeInternals(t){return{starts:t.#x,ttls:t.#w,sizes:t.#E,keyMap:t.#a,keyList:t.#l,valList:t.#n,next:t.#g,prev:t.#A,get head(){return t.#f},get tail(){return t.#d},free:t.#S,isBackgroundFetch:e=>t.#h(e),backgroundFetch:(e,s,n,r)=>t.#L(e,s,n,r),moveToTail:e=>t.#W(e),indexes:e=>t.#B(e),rindexes:e=>t.#T(e),isStale:e=>t.#b(e)}}get max(){return this.#t}get maxSize(){return this.#e}get calculatedSize(){return this.#u}get size(){return this.#c}get fetchMethod(){return this.#o}get memoMethod(){return this.#k}get dispose(){return this.#r}get disposeAfter(){return this.#s}constructor(t){let{max:e=0,ttl:s,ttlResolution:n=1,ttlAutopurge:r,updateAgeOnGet:o,updateAgeOnHas:a,allowStale:l,dispose:c,disposeAfter:h,noDisposeOnSet:u,noUpdateTTL:d,maxSize:f=0,maxEntrySize:b=0,sizeCalculation:p,fetchMethod:k,memoMethod:A,noDeleteOnFetchRejection:S,noDeleteOnStaleGet:v,allowStaleOnFetchRejection:y,allowStaleOnFetchAbort:x,ignoreFetchAbort:R}=t;if(e!==0&&!Ct(e))throw new TypeError("max option must be a nonnegative integer");let nt=e?Ns(e):Array;if(!nt)throw new Error("invalid max value: "+e);if(this.#t=e,this.#e=f,this.maxEntrySize=b||this.#e,this.sizeCalculation=p,this.sizeCalculation){if(!this.#e&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(A!==void 0&&typeof A!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#k=A,k!==void 0&&typeof k!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#o=k,this.#v=!!k,this.#a=new Map,this.#l=new Array(e).fill(void 0),this.#n=new Array(e).fill(void 0),this.#g=new nt(e),this.#A=new nt(e),this.#f=0,this.#d=0,this.#S=gi.create(e),this.#c=0,this.#u=0,typeof c=="function"&&(this.#r=c),typeof h=="function"?(this.#s=h,this.#m=[]):(this.#s=void 0,this.#m=void 0),this.#y=!!this.#r,this.#p=!!this.#s,this.noDisposeOnSet=!!u,this.noUpdateTTL=!!d,this.noDeleteOnFetchRejection=!!S,this.allowStaleOnFetchRejection=!!y,this.allowStaleOnFetchAbort=!!x,this.ignoreFetchAbort=!!R,this.maxEntrySize!==0){if(this.#e!==0&&!Ct(this.#e))throw new TypeError("maxSize must be a positive integer if specified");if(!Ct(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#R()}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!v,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!a,this.ttlResolution=Ct(n)||n===0?n:1,this.ttlAutopurge=!!r,this.ttl=s||0,this.ttl){if(!Ct(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#I()}if(this.#t===0&&this.ttl===0&&this.#e===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#e){let Ot="LRU_CACHE_UNBOUNDED";oo(Ot)&&(Ps.add(Ot),Fs("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",Ot,i))}}getRemainingTTL(t){return this.#a.has(t)?1/0:0}#I(){let t=new _t(this.#t),e=new _t(this.#t);this.#w=t,this.#x=e,this.#D=(r,o,a=jt.now())=>{if(e[r]=o!==0?a:0,t[r]=o,o!==0&&this.ttlAutopurge){let l=setTimeout(()=>{this.#b(r)&&this.#O(this.#l[r],"expire")},o+1);l.unref&&l.unref()}},this.#C=r=>{e[r]=t[r]!==0?jt.now():0},this.#i=(r,o)=>{if(t[o]){let a=t[o],l=e[o];if(!a||!l)return;r.ttl=a,r.start=l,r.now=s||n();let c=r.now-l;r.remainingTTL=a-c}};let s=0,n=()=>{let r=jt.now();if(this.ttlResolution>0){s=r;let o=setTimeout(()=>s=0,this.ttlResolution);o.unref&&o.unref()}return r};this.getRemainingTTL=r=>{let o=this.#a.get(r);if(o===void 0)return 0;let a=t[o],l=e[o];if(!a||!l)return 1/0;let c=(s||n())-l;return a-c},this.#b=r=>{let o=e[r],a=t[r];return!!a&&!!o&&(s||n())-o>a}}#C=()=>{};#i=()=>{};#D=()=>{};#b=()=>!1;#R(){let t=new _t(this.#t);this.#u=0,this.#E=t,this.#P=e=>{this.#u-=t[e],t[e]=0},this.#N=(e,s,n,r)=>{if(this.#h(s))return 0;if(!Ct(n))if(r){if(typeof r!="function")throw new TypeError("sizeCalculation must be a function");if(n=r(s,e),!Ct(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return n},this.#F=(e,s,n)=>{if(t[e]=s,this.#e){let r=this.#e-t[e];for(;this.#u>r;)this.#M(!0)}this.#u+=t[e],n&&(n.entrySize=s,n.totalCalculatedSize=this.#u)}}#P=t=>{};#F=(t,e,s)=>{};#N=(t,e,s,n)=>{if(s||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#B({allowStale:t=this.allowStale}={}){if(this.#c)for(let e=this.#d;!(!this.#U(e)||((t||!this.#b(e))&&(yield e),e===this.#f));)e=this.#A[e]}*#T({allowStale:t=this.allowStale}={}){if(this.#c)for(let e=this.#f;!(!this.#U(e)||((t||!this.#b(e))&&(yield e),e===this.#d));)e=this.#g[e]}#U(t){return t!==void 0&&this.#a.get(this.#l[t])===t}*entries(){for(let t of this.#B())this.#n[t]!==void 0&&this.#l[t]!==void 0&&!this.#h(this.#n[t])&&(yield[this.#l[t],this.#n[t]])}*rentries(){for(let t of this.#T())this.#n[t]!==void 0&&this.#l[t]!==void 0&&!this.#h(this.#n[t])&&(yield[this.#l[t],this.#n[t]])}*keys(){for(let t of this.#B()){let e=this.#l[t];e!==void 0&&!this.#h(this.#n[t])&&(yield e)}}*rkeys(){for(let t of this.#T()){let e=this.#l[t];e!==void 0&&!this.#h(this.#n[t])&&(yield e)}}*values(){for(let t of this.#B())this.#n[t]!==void 0&&!this.#h(this.#n[t])&&(yield this.#n[t])}*rvalues(){for(let t of this.#T())this.#n[t]!==void 0&&!this.#h(this.#n[t])&&(yield this.#n[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(let s of this.#B()){let n=this.#n[s],r=this.#h(n)?n.__staleWhileFetching:n;if(r!==void 0&&t(r,this.#l[s],this))return this.get(this.#l[s],e)}}forEach(t,e=this){for(let s of this.#B()){let n=this.#n[s],r=this.#h(n)?n.__staleWhileFetching:n;r!==void 0&&t.call(e,r,this.#l[s],this)}}rforEach(t,e=this){for(let s of this.#T()){let n=this.#n[s],r=this.#h(n)?n.__staleWhileFetching:n;r!==void 0&&t.call(e,r,this.#l[s],this)}}purgeStale(){let t=!1;for(let e of this.#T({allowStale:!0}))this.#b(e)&&(this.#O(this.#l[e],"expire"),t=!0);return t}info(t){let e=this.#a.get(t);if(e===void 0)return;let s=this.#n[e],n=this.#h(s)?s.__staleWhileFetching:s;if(n===void 0)return;let r={value:n};if(this.#w&&this.#x){let o=this.#w[e],a=this.#x[e];if(o&&a){let l=o-(jt.now()-a);r.ttl=l,r.start=Date.now()}}return this.#E&&(r.size=this.#E[e]),r}dump(){let t=[];for(let e of this.#B({allowStale:!0})){let s=this.#l[e],n=this.#n[e],r=this.#h(n)?n.__staleWhileFetching:n;if(r===void 0||s===void 0)continue;let o={value:r};if(this.#w&&this.#x){o.ttl=this.#w[e];let a=jt.now()-this.#x[e];o.start=Math.floor(Date.now()-a)}this.#E&&(o.size=this.#E[e]),t.unshift([s,o])}return t}load(t){this.clear();for(let[e,s]of t){if(s.start){let n=Date.now()-s.start;s.start=jt.now()-n}this.set(e,s.value,s)}}set(t,e,s={}){if(e===void 0)return this.delete(t),this;let{ttl:n=this.ttl,start:r,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:l}=s,{noUpdateTTL:c=this.noUpdateTTL}=s,h=this.#N(t,e,s.size||0,a);if(this.maxEntrySize&&h>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),this.#O(t,"set"),this;let u=this.#c===0?void 0:this.#a.get(t);if(u===void 0)u=this.#c===0?this.#d:this.#S.length!==0?this.#S.pop():this.#c===this.#t?this.#M(!1):this.#c,this.#l[u]=t,this.#n[u]=e,this.#a.set(t,u),this.#g[this.#d]=u,this.#A[u]=this.#d,this.#d=u,this.#c++,this.#F(u,h,l),l&&(l.set="add"),c=!1;else{this.#W(u);let d=this.#n[u];if(e!==d){if(this.#v&&this.#h(d)){d.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:f}=d;f!==void 0&&!o&&(this.#y&&this.#r?.(f,t,"set"),this.#p&&this.#m?.push([f,t,"set"]))}else o||(this.#y&&this.#r?.(d,t,"set"),this.#p&&this.#m?.push([d,t,"set"]));if(this.#P(u),this.#F(u,h,l),this.#n[u]=e,l){l.set="replace";let f=d&&this.#h(d)?d.__staleWhileFetching:d;f!==void 0&&(l.oldValue=f)}}else l&&(l.set="update")}if(n!==0&&!this.#w&&this.#I(),this.#w&&(c||this.#D(u,n,r),l&&this.#i(l,u)),!o&&this.#p&&this.#m){let d=this.#m,f;for(;f=d?.shift();)this.#s?.(...f)}return this}pop(){try{for(;this.#c;){let t=this.#n[this.#f];if(this.#M(!0),this.#h(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(this.#p&&this.#m){let t=this.#m,e;for(;e=t?.shift();)this.#s?.(...e)}}}#M(t){let e=this.#f,s=this.#l[e],n=this.#n[e];return this.#v&&this.#h(n)?n.__abortController.abort(new Error("evicted")):(this.#y||this.#p)&&(this.#y&&this.#r?.(n,s,"evict"),this.#p&&this.#m?.push([n,s,"evict"])),this.#P(e),t&&(this.#l[e]=void 0,this.#n[e]=void 0,this.#S.push(e)),this.#c===1?(this.#f=this.#d=0,this.#S.length=0):this.#f=this.#g[e],this.#a.delete(s),this.#c--,e}has(t,e={}){let{updateAgeOnHas:s=this.updateAgeOnHas,status:n}=e,r=this.#a.get(t);if(r!==void 0){let o=this.#n[r];if(this.#h(o)&&o.__staleWhileFetching===void 0)return!1;if(this.#b(r))n&&(n.has="stale",this.#i(n,r));else return s&&this.#C(r),n&&(n.has="hit",this.#i(n,r)),!0}else n&&(n.has="miss");return!1}peek(t,e={}){let{allowStale:s=this.allowStale}=e,n=this.#a.get(t);if(n===void 0||!s&&this.#b(n))return;let r=this.#n[n];return this.#h(r)?r.__staleWhileFetching:r}#L(t,e,s,n){let r=e===void 0?void 0:this.#n[e];if(this.#h(r))return r;let o=new Ue,{signal:a}=s;a?.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});let l={signal:o.signal,options:s,context:n},c=(p,k=!1)=>{let{aborted:A}=o.signal,S=s.ignoreFetchAbort&&p!==void 0;if(s.status&&(A&&!k?(s.status.fetchAborted=!0,s.status.fetchError=o.signal.reason,S&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),A&&!S&&!k)return u(o.signal.reason);let v=f;return this.#n[e]===f&&(p===void 0?v.__staleWhileFetching?this.#n[e]=v.__staleWhileFetching:this.#O(t,"fetch"):(s.status&&(s.status.fetchUpdated=!0),this.set(t,p,l.options))),p},h=p=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=p),u(p)),u=p=>{let{aborted:k}=o.signal,A=k&&s.allowStaleOnFetchAbort,S=A||s.allowStaleOnFetchRejection,v=S||s.noDeleteOnFetchRejection,y=f;if(this.#n[e]===f&&(!v||y.__staleWhileFetching===void 0?this.#O(t,"fetch"):A||(this.#n[e]=y.__staleWhileFetching)),S)return s.status&&y.__staleWhileFetching!==void 0&&(s.status.returnedStale=!0),y.__staleWhileFetching;if(y.__returned===y)throw p},d=(p,k)=>{let A=this.#o?.(t,r,l);A&&A instanceof Promise&&A.then(S=>p(S===void 0?void 0:S),k),o.signal.addEventListener("abort",()=>{(!s.ignoreFetchAbort||s.allowStaleOnFetchAbort)&&(p(void 0),s.allowStaleOnFetchAbort&&(p=S=>c(S,!0)))})};s.status&&(s.status.fetchDispatched=!0);let f=new Promise(d).then(c,h),b=Object.assign(f,{__abortController:o,__staleWhileFetching:r,__returned:void 0});return e===void 0?(this.set(t,b,{...l.options,status:void 0}),e=this.#a.get(t)):this.#n[e]=b,b}#h(t){if(!this.#v)return!1;let e=t;return!!e&&e instanceof Promise&&e.hasOwnProperty("__staleWhileFetching")&&e.__abortController instanceof Ue}async fetch(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:l=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:d=this.allowStaleOnFetchRejection,ignoreFetchAbort:f=this.ignoreFetchAbort,allowStaleOnFetchAbort:b=this.allowStaleOnFetchAbort,context:p,forceRefresh:k=!1,status:A,signal:S}=e;if(!this.#v)return A&&(A.fetch="get"),this.get(t,{allowStale:s,updateAgeOnGet:n,noDeleteOnStaleGet:r,status:A});let v={allowStale:s,updateAgeOnGet:n,noDeleteOnStaleGet:r,ttl:o,noDisposeOnSet:a,size:l,sizeCalculation:c,noUpdateTTL:h,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:d,allowStaleOnFetchAbort:b,ignoreFetchAbort:f,status:A,signal:S},y=this.#a.get(t);if(y===void 0){A&&(A.fetch="miss");let x=this.#L(t,y,v,p);return x.__returned=x}else{let x=this.#n[y];if(this.#h(x)){let Re=s&&x.__staleWhileFetching!==void 0;return A&&(A.fetch="inflight",Re&&(A.returnedStale=!0)),Re?x.__staleWhileFetching:x.__returned=x}let R=this.#b(y);if(!k&&!R)return A&&(A.fetch="hit"),this.#W(y),n&&this.#C(y),A&&this.#i(A,y),x;let nt=this.#L(t,y,v,p),rt=nt.__staleWhileFetching!==void 0&&s;return A&&(A.fetch=R?"stale":"refresh",rt&&R&&(A.returnedStale=!0)),rt?nt.__staleWhileFetching:nt.__returned=nt}}async forceFetch(t,e={}){let s=await this.fetch(t,e);if(s===void 0)throw new Error("fetch() returned undefined");return s}memo(t,e={}){let s=this.#k;if(!s)throw new Error("no memoMethod provided to constructor");let{context:n,forceRefresh:r,...o}=e,a=this.get(t,o);if(!r&&a!==void 0)return a;let l=s(t,a,{options:o,context:n});return this.set(t,l,o),l}get(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,status:o}=e,a=this.#a.get(t);if(a!==void 0){let l=this.#n[a],c=this.#h(l);return o&&this.#i(o,a),this.#b(a)?(o&&(o.get="stale"),c?(o&&s&&l.__staleWhileFetching!==void 0&&(o.returnedStale=!0),s?l.__staleWhileFetching:void 0):(r||this.#O(t,"expire"),o&&s&&(o.returnedStale=!0),s?l:void 0)):(o&&(o.get="hit"),c?l.__staleWhileFetching:(this.#W(a),n&&this.#C(a),l))}else o&&(o.get="miss")}#z(t,e){this.#A[e]=t,this.#g[t]=e}#W(t){t!==this.#d&&(t===this.#f?this.#f=this.#g[t]:this.#z(this.#A[t],this.#g[t]),this.#z(this.#d,t),this.#d=t)}delete(t){return this.#O(t,"delete")}#O(t,e){let s=!1;if(this.#c!==0){let n=this.#a.get(t);if(n!==void 0)if(s=!0,this.#c===1)this.#j(e);else{this.#P(n);let r=this.#n[n];if(this.#h(r)?r.__abortController.abort(new Error("deleted")):(this.#y||this.#p)&&(this.#y&&this.#r?.(r,t,e),this.#p&&this.#m?.push([r,t,e])),this.#a.delete(t),this.#l[n]=void 0,this.#n[n]=void 0,n===this.#d)this.#d=this.#A[n];else if(n===this.#f)this.#f=this.#g[n];else{let o=this.#A[n];this.#g[o]=this.#g[n];let a=this.#g[n];this.#A[a]=this.#A[n]}this.#c--,this.#S.push(n)}}if(this.#p&&this.#m?.length){let n=this.#m,r;for(;r=n?.shift();)this.#s?.(...r)}return s}clear(){return this.#j("delete")}#j(t){for(let e of this.#T({allowStale:!0})){let s=this.#n[e];if(this.#h(s))s.__abortController.abort(new Error("deleted"));else{let n=this.#l[e];this.#y&&this.#r?.(s,n,t),this.#p&&this.#m?.push([s,n,t])}}if(this.#a.clear(),this.#n.fill(void 0),this.#l.fill(void 0),this.#w&&this.#x&&(this.#w.fill(0),this.#x.fill(0)),this.#E&&this.#E.fill(0),this.#f=0,this.#d=0,this.#S.length=0,this.#u=0,this.#c=0,this.#p&&this.#m){let e=this.#m,s;for(;s=e?.shift();)this.#s?.(...s)}}};var $t=require("node:path"),$s=require("node:url"),mt=require("fs"),Ao=Mt(require("node:fs"),1),It=require("node:fs/promises");var Qe=require("node:events"),Si=Mt(require("node:stream"),1),Ws=require("node:string_decoder"),Us=typeof process=="object"&&process?process:{stdout:null,stderr:null},ao=i=>!!i&&typeof i=="object"&&(i instanceof Tt||i instanceof Si.default||lo(i)||co(i)),lo=i=>!!i&&typeof i=="object"&&i instanceof Qe.EventEmitter&&typeof i.pipe=="function"&&i.pipe!==Si.default.Writable.prototype.pipe,co=i=>!!i&&typeof i=="object"&&i instanceof Qe.EventEmitter&&typeof i.write=="function"&&typeof i.end=="function",wt=Symbol("EOF"),kt=Symbol("maybeEmitEnd"),Bt=Symbol("emittedEnd"),Me=Symbol("emittingEnd"),ue=Symbol("emittedError"),Le=Symbol("closed"),Ms=Symbol("read"),ze=Symbol("flush"),Ls=Symbol("flushChunk"),at=Symbol("encoding"),Qt=Symbol("decoder"),O=Symbol("flowing"),de=Symbol("paused"),Vt=Symbol("resume"),D=Symbol("buffer"),Q=Symbol("pipes"),P=Symbol("bufferLength"),Ai=Symbol("bufferPush"),We=Symbol("bufferShift"),L=Symbol("objectMode"),T=Symbol("destroyed"),bi=Symbol("error"),wi=Symbol("emitData"),zs=Symbol("emitEnd"),ki=Symbol("emitEnd2"),ft=Symbol("async"),yi=Symbol("abort"),je=Symbol("aborted"),fe=Symbol("signal"),Ft=Symbol("dataListeners"),X=Symbol("discarded"),pe=i=>Promise.resolve().then(i),ho=i=>i(),uo=i=>i==="end"||i==="finish"||i==="prefinish",fo=i=>i instanceof ArrayBuffer||!!i&&typeof i=="object"&&i.constructor&&i.constructor.name==="ArrayBuffer"&&i.byteLength>=0,po=i=>!Buffer.isBuffer(i)&&ArrayBuffer.isView(i),_e=class{src;dest;opts;ondrain;constructor(t,e,s){this.src=t,this.dest=e,this.opts=s,this.ondrain=()=>t[Vt](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(t){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},vi=class extends _e{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(t,e,s){super(t,e,s),this.proxyErrors=n=>e.emit("error",n),t.on("error",this.proxyErrors)}},mo=i=>!!i.objectMode,go=i=>!i.objectMode&&!!i.encoding&&i.encoding!=="buffer",Tt=class extends Qe.EventEmitter{[O]=!1;[de]=!1;[Q]=[];[D]=[];[L];[at];[ft];[Qt];[wt]=!1;[Bt]=!1;[Me]=!1;[Le]=!1;[ue]=null;[P]=0;[T]=!1;[fe];[je]=!1;[Ft]=0;[X]=!1;writable=!0;readable=!0;constructor(...t){let e=t[0]||{};if(super(),e.objectMode&&typeof e.encoding=="string")throw new TypeError("Encoding and objectMode may not be used together");mo(e)?(this[L]=!0,this[at]=null):go(e)?(this[at]=e.encoding,this[L]=!1):(this[L]=!1,this[at]=null),this[ft]=!!e.async,this[Qt]=this[at]?new Ws.StringDecoder(this[at]):null,e&&e.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:()=>this[D]}),e&&e.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:()=>this[Q]});let{signal:s}=e;s&&(this[fe]=s,s.aborted?this[yi]():s.addEventListener("abort",()=>this[yi]()))}get bufferLength(){return this[P]}get encoding(){return this[at]}set encoding(t){throw new Error("Encoding must be set at instantiation time")}setEncoding(t){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[L]}set objectMode(t){throw new Error("objectMode must be set at instantiation time")}get async(){return this[ft]}set async(t){this[ft]=this[ft]||!!t}[yi](){this[je]=!0,this.emit("abort",this[fe]?.reason),this.destroy(this[fe]?.reason)}get aborted(){return this[je]}set aborted(t){}write(t,e,s){if(this[je])return!1;if(this[wt])throw new Error("write after end");if(this[T])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof e=="function"&&(s=e,e="utf8"),e||(e="utf8");let n=this[ft]?pe:ho;if(!this[L]&&!Buffer.isBuffer(t)){if(po(t))t=Buffer.from(t.buffer,t.byteOffset,t.byteLength);else if(fo(t))t=Buffer.from(t);else if(typeof t!="string")throw new Error("Non-contiguous data written to non-objectMode stream")}return this[L]?(this[O]&&this[P]!==0&&this[ze](!0),this[O]?this.emit("data",t):this[Ai](t),this[P]!==0&&this.emit("readable"),s&&n(s),this[O]):t.length?(typeof t=="string"&&!(e===this[at]&&!this[Qt]?.lastNeed)&&(t=Buffer.from(t,e)),Buffer.isBuffer(t)&&this[at]&&(t=this[Qt].write(t)),this[O]&&this[P]!==0&&this[ze](!0),this[O]?this.emit("data",t):this[Ai](t),this[P]!==0&&this.emit("readable"),s&&n(s),this[O]):(this[P]!==0&&this.emit("readable"),s&&n(s),this[O])}read(t){if(this[T])return null;if(this[X]=!1,this[P]===0||t===0||t&&t>this[P])return this[kt](),null;this[L]&&(t=null),this[D].length>1&&!this[L]&&(this[D]=[this[at]?this[D].join(""):Buffer.concat(this[D],this[P])]);let e=this[Ms](t||null,this[D][0]);return this[kt](),e}[Ms](t,e){if(this[L])this[We]();else{let s=e;t===s.length||t===null?this[We]():typeof s=="string"?(this[D][0]=s.slice(t),e=s.slice(0,t),this[P]-=t):(this[D][0]=s.subarray(t),e=s.subarray(0,t),this[P]-=t)}return this.emit("data",e),!this[D].length&&!this[wt]&&this.emit("drain"),e}end(t,e,s){return typeof t=="function"&&(s=t,t=void 0),typeof e=="function"&&(s=e,e="utf8"),t!==void 0&&this.write(t,e),s&&this.once("end",s),this[wt]=!0,this.writable=!1,(this[O]||!this[de])&&this[kt](),this}[Vt](){this[T]||(!this[Ft]&&!this[Q].length&&(this[X]=!0),this[de]=!1,this[O]=!0,this.emit("resume"),this[D].length?this[ze]():this[wt]?this[kt]():this.emit("drain"))}resume(){return this[Vt]()}pause(){this[O]=!1,this[de]=!0,this[X]=!1}get destroyed(){return this[T]}get flowing(){return this[O]}get paused(){return this[de]}[Ai](t){this[L]?this[P]+=1:this[P]+=t.length,this[D].push(t)}[We](){return this[L]?this[P]-=1:this[P]-=this[D][0].length,this[D].shift()}[ze](t=!1){do;while(this[Ls](this[We]())&&this[D].length);!t&&!this[D].length&&!this[wt]&&this.emit("drain")}[Ls](t){return this.emit("data",t),this[O]}pipe(t,e){if(this[T])return t;this[X]=!1;let s=this[Bt];return e=e||{},t===Us.stdout||t===Us.stderr?e.end=!1:e.end=e.end!==!1,e.proxyErrors=!!e.proxyErrors,s?e.end&&t.end():(this[Q].push(e.proxyErrors?new vi(this,t,e):new _e(this,t,e)),this[ft]?pe(()=>this[Vt]()):this[Vt]()),t}unpipe(t){let e=this[Q].find(s=>s.dest===t);e&&(this[Q].length===1?(this[O]&&this[Ft]===0&&(this[O]=!1),this[Q]=[]):this[Q].splice(this[Q].indexOf(e),1),e.unpipe())}addListener(t,e){return this.on(t,e)}on(t,e){let s=super.on(t,e);if(t==="data")this[X]=!1,this[Ft]++,!this[Q].length&&!this[O]&&this[Vt]();else if(t==="readable"&&this[P]!==0)super.emit("readable");else if(uo(t)&&this[Bt])super.emit(t),this.removeAllListeners(t);else if(t==="error"&&this[ue]){let n=e;this[ft]?pe(()=>n.call(this,this[ue])):n.call(this,this[ue])}return s}removeListener(t,e){return this.off(t,e)}off(t,e){let s=super.off(t,e);return t==="data"&&(this[Ft]=this.listeners("data").length,this[Ft]===0&&!this[X]&&!this[Q].length&&(this[O]=!1)),s}removeAllListeners(t){let e=super.removeAllListeners(t);return(t==="data"||t===void 0)&&(this[Ft]=0,!this[X]&&!this[Q].length&&(this[O]=!1)),e}get emittedEnd(){return this[Bt]}[kt](){!this[Me]&&!this[Bt]&&!this[T]&&this[D].length===0&&this[wt]&&(this[Me]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[Le]&&this.emit("close"),this[Me]=!1)}emit(t,...e){let s=e[0];if(t!=="error"&&t!=="close"&&t!==T&&this[T])return!1;if(t==="data")return!this[L]&&!s?!1:this[ft]?(pe(()=>this[wi](s)),!0):this[wi](s);if(t==="end")return this[zs]();if(t==="close"){if(this[Le]=!0,!this[Bt]&&!this[T])return!1;let r=super.emit("close");return this.removeAllListeners("close"),r}else if(t==="error"){this[ue]=s,super.emit(bi,s);let r=!this[fe]||this.listeners("error").length?super.emit("error",s):!1;return this[kt](),r}else if(t==="resume"){let r=super.emit("resume");return this[kt](),r}else if(t==="finish"||t==="prefinish"){let r=super.emit(t);return this.removeAllListeners(t),r}let n=super.emit(t,...e);return this[kt](),n}[wi](t){for(let s of this[Q])s.dest.write(t)===!1&&this.pause();let e=this[X]?!1:super.emit("data",t);return this[kt](),e}[zs](){return this[Bt]?!1:(this[Bt]=!0,this.readable=!1,this[ft]?(pe(()=>this[ki]()),!0):this[ki]())}[ki](){if(this[Qt]){let e=this[Qt].end();if(e){for(let s of this[Q])s.dest.write(e);this[X]||super.emit("data",e)}}for(let e of this[Q])e.end();let t=super.emit("end");return this.removeAllListeners("end"),t}async collect(){let t=Object.assign([],{dataLength:0});this[L]||(t.dataLength=0);let e=this.promise();return this.on("data",s=>{t.push(s),this[L]||(t.dataLength+=s.length)}),await e,t}async concat(){if(this[L])throw new Error("cannot concat in objectMode");let t=await this.collect();return this[at]?t.join(""):Buffer.concat(t,t.dataLength)}async promise(){return new Promise((t,e)=>{this.on(T,()=>e(new Error("stream destroyed"))),this.on("error",s=>e(s)),this.on("end",()=>t())})}[Symbol.asyncIterator](){this[X]=!1;let t=!1,e=async()=>(this.pause(),t=!0,{value:void 0,done:!0});return{next:()=>{if(t)return e();let n=this.read();if(n!==null)return Promise.resolve({done:!1,value:n});if(this[wt])return e();let r,o,a=u=>{this.off("data",l),this.off("end",c),this.off(T,h),e(),o(u)},l=u=>{this.off("error",a),this.off("end",c),this.off(T,h),this.pause(),r({value:u,done:!!this[wt]})},c=()=>{this.off("error",a),this.off("data",l),this.off(T,h),e(),r({done:!0,value:void 0})},h=()=>a(new Error("stream destroyed"));return new Promise((u,d)=>{o=d,r=u,this.once(T,h),this.once("error",a),this.once("end",c),this.once("data",l)})},throw:e,return:e,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[X]=!1;let t=!1,e=()=>(this.pause(),this.off(bi,e),this.off(T,e),this.off("end",e),t=!0,{done:!0,value:void 0}),s=()=>{if(t)return e();let n=this.read();return n===null?e():{done:!1,value:n}};return this.once("end",e),this.once(bi,e),this.once(T,e),{next:s,throw:e,return:e,[Symbol.iterator](){return this}}}destroy(t){if(this[T])return t?this.emit("error",t):this.emit(T),this;this[T]=!0,this[X]=!0,this[D].length=0,this[P]=0;let e=this;return typeof e.close=="function"&&!this[Le]&&e.close(),t?this.emit("error",t):this.emit(T),this}static get isStream(){return ao}};var bo=mt.realpathSync.native,ge={lstatSync:mt.lstatSync,readdir:mt.readdir,readdirSync:mt.readdirSync,readlinkSync:mt.readlinkSync,realpathSync:bo,promises:{lstat:It.lstat,readdir:It.readdir,readlink:It.readlink,realpath:It.realpath}},Xs=i=>!i||i===ge||i===Ao?ge:{...ge,...i,promises:{...ge.promises,...i.promises||{}}},Hs=/^\\\\\?\\([a-z]:)\\?$/i,wo=i=>i.replace(/\//g,"\\").replace(Hs,"$1\\"),ko=/[\\\/]/,tt=0,Gs=1,Zs=2,pt=4,qs=6,Ys=8,Nt=10,Js=12,K=15,me=~K,Ei=16,js=32,Ae=64,lt=128,Ve=256,Xe=512,_s=Ae|lt|Xe,yo=1023,xi=i=>i.isFile()?Ys:i.isDirectory()?pt:i.isSymbolicLink()?Nt:i.isCharacterDevice()?Zs:i.isBlockDevice()?qs:i.isSocket()?Js:i.isFIFO()?Gs:tt,Qs=new Map,be=i=>{let t=Qs.get(i);if(t)return t;let e=i.normalize("NFKD");return Qs.set(i,e),e},Vs=new Map,$e=i=>{let t=Vs.get(i);if(t)return t;let e=be(i.toLowerCase());return Vs.set(i,e),e},He=class extends he{constructor(){super({max:256})}},Ci=class extends he{constructor(t=16*1024){super({maxSize:t,sizeCalculation:e=>e.length+1})}},Ks=Symbol("PathScurry setAsCwd"),z=class{name;root;roots;parent;nocase;isCWD=!1;#t;#e;get dev(){return this.#e}#r;get mode(){return this.#r}#s;get nlink(){return this.#s}#o;get uid(){return this.#o}#k;get gid(){return this.#k}#c;get rdev(){return this.#c}#u;get blksize(){return this.#u}#a;get ino(){return this.#a}#l;get size(){return this.#l}#n;get blocks(){return this.#n}#g;get atimeMs(){return this.#g}#A;get mtimeMs(){return this.#A}#f;get ctimeMs(){return this.#f}#d;get birthtimeMs(){return this.#d}#S;get atime(){return this.#S}#m;get mtime(){return this.#m}#E;get ctime(){return this.#E}#x;get birthtime(){return this.#x}#w;#y;#v;#p;#I;#C;#i;#D;#b;#R;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(t,e=tt,s,n,r,o,a){this.name=t,this.#w=r?$e(t):be(t),this.#i=e&yo,this.nocase=r,this.roots=n,this.root=s||this,this.#D=o,this.#v=a.fullpath,this.#I=a.relative,this.#C=a.relativePosix,this.parent=a.parent,this.parent?this.#t=this.parent.#t:this.#t=Xs(a.fs)}depth(){return this.#y!==void 0?this.#y:this.parent?this.#y=this.parent.depth()+1:this.#y=0}childrenCache(){return this.#D}resolve(t){if(!t)return this;let e=this.getRootString(t),n=t.substring(e.length).split(this.splitSep);return e?this.getRoot(e).#P(n):this.#P(n)}#P(t){let e=this;for(let s of t)e=e.child(s);return e}children(){let t=this.#D.get(this);if(t)return t;let e=Object.assign([],{provisional:0});return this.#D.set(this,e),this.#i&=~Ei,e}child(t,e){if(t===""||t===".")return this;if(t==="..")return this.parent||this;let s=this.children(),n=this.nocase?$e(t):be(t);for(let l of s)if(l.#w===n)return l;let r=this.parent?this.sep:"",o=this.#v?this.#v+r+t:void 0,a=this.newChild(t,tt,{...e,parent:this,fullpath:o});return this.canReaddir()||(a.#i|=lt),s.push(a),a}relative(){if(this.isCWD)return"";if(this.#I!==void 0)return this.#I;let t=this.name,e=this.parent;if(!e)return this.#I=this.name;let s=e.relative();return s+(!s||!e.parent?"":this.sep)+t}relativePosix(){if(this.sep==="/")return this.relative();if(this.isCWD)return"";if(this.#C!==void 0)return this.#C;let t=this.name,e=this.parent;if(!e)return this.#C=this.fullpathPosix();let s=e.relativePosix();return s+(!s||!e.parent?"":"/")+t}fullpath(){if(this.#v!==void 0)return this.#v;let t=this.name,e=this.parent;if(!e)return this.#v=this.name;let n=e.fullpath()+(e.parent?this.sep:"")+t;return this.#v=n}fullpathPosix(){if(this.#p!==void 0)return this.#p;if(this.sep==="/")return this.#p=this.fullpath();if(!this.parent){let n=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(n)?this.#p=`//?/${n}`:this.#p=n}let t=this.parent,e=t.fullpathPosix(),s=e+(!e||!t.parent?"":"/")+this.name;return this.#p=s}isUnknown(){return(this.#i&K)===tt}isType(t){return this[`is${t}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return(this.#i&K)===Ys}isDirectory(){return(this.#i&K)===pt}isCharacterDevice(){return(this.#i&K)===Zs}isBlockDevice(){return(this.#i&K)===qs}isFIFO(){return(this.#i&K)===Gs}isSocket(){return(this.#i&K)===Js}isSymbolicLink(){return(this.#i&Nt)===Nt}lstatCached(){return this.#i&js?this:void 0}readlinkCached(){return this.#b}realpathCached(){return this.#R}readdirCached(){let t=this.children();return t.slice(0,t.provisional)}canReadlink(){if(this.#b)return!0;if(!this.parent)return!1;let t=this.#i&K;return!(t!==tt&&t!==Nt||this.#i&Ve||this.#i&lt)}calledReaddir(){return!!(this.#i&Ei)}isENOENT(){return!!(this.#i&lt)}isNamed(t){return this.nocase?this.#w===$e(t):this.#w===be(t)}async readlink(){let t=this.#b;if(t)return t;if(this.canReadlink()&&this.parent)try{let e=await this.#t.promises.readlink(this.fullpath()),s=(await this.parent.realpath())?.resolve(e);if(s)return this.#b=s}catch(e){this.#h(e.code);return}}readlinkSync(){let t=this.#b;if(t)return t;if(this.canReadlink()&&this.parent)try{let e=this.#t.readlinkSync(this.fullpath()),s=this.parent.realpathSync()?.resolve(e);if(s)return this.#b=s}catch(e){this.#h(e.code);return}}#F(t){this.#i|=Ei;for(let e=t.provisional;e<t.length;e++){let s=t[e];s&&s.#N()}}#N(){this.#i&lt||(this.#i=(this.#i|lt)&me,this.#B())}#B(){let t=this.children();t.provisional=0;for(let e of t)e.#N()}#T(){this.#i|=Xe,this.#U()}#U(){if(this.#i&Ae)return;let t=this.#i;(t&K)===pt&&(t&=me),this.#i=t|Ae,this.#B()}#M(t=""){t==="ENOTDIR"||t==="EPERM"?this.#U():t==="ENOENT"?this.#N():this.children().provisional=0}#L(t=""){t==="ENOTDIR"?this.parent.#U():t==="ENOENT"&&this.#N()}#h(t=""){let e=this.#i;e|=Ve,t==="ENOENT"&&(e|=lt),(t==="EINVAL"||t==="UNKNOWN")&&(e&=me),this.#i=e,t==="ENOTDIR"&&this.parent&&this.parent.#U()}#z(t,e){return this.#O(t,e)||this.#W(t,e)}#W(t,e){let s=xi(t),n=this.newChild(t.name,s,{parent:this}),r=n.#i&K;return r!==pt&&r!==Nt&&r!==tt&&(n.#i|=Ae),e.unshift(n),e.provisional++,n}#O(t,e){for(let s=e.provisional;s<e.length;s++){let n=e[s];if((this.nocase?$e(t.name):be(t.name))===n.#w)return this.#j(t,n,s,e)}}#j(t,e,s,n){let r=e.name;return e.#i=e.#i&me|xi(t),r!==t.name&&(e.name=t.name),s!==n.provisional&&(s===n.length-1?n.pop():n.splice(s,1),n.unshift(e)),n.provisional++,e}async lstat(){if(!(this.#i&lt))try{return this.#$(await this.#t.promises.lstat(this.fullpath())),this}catch(t){this.#L(t.code)}}lstatSync(){if(!(this.#i&lt))try{return this.#$(this.#t.lstatSync(this.fullpath())),this}catch(t){this.#L(t.code)}}#$(t){let{atime:e,atimeMs:s,birthtime:n,birthtimeMs:r,blksize:o,blocks:a,ctime:l,ctimeMs:c,dev:h,gid:u,ino:d,mode:f,mtime:b,mtimeMs:p,nlink:k,rdev:A,size:S,uid:v}=t;this.#S=e,this.#g=s,this.#x=n,this.#d=r,this.#u=o,this.#n=a,this.#E=l,this.#f=c,this.#e=h,this.#k=u,this.#a=d,this.#r=f,this.#m=b,this.#A=p,this.#s=k,this.#c=A,this.#l=S,this.#o=v;let y=xi(t);this.#i=this.#i&me|y|js,y!==tt&&y!==pt&&y!==Nt&&(this.#i|=Ae)}#Q=[];#V=!1;#X(t){this.#V=!1;let e=this.#Q.slice();this.#Q.length=0,e.forEach(s=>s(null,t))}readdirCB(t,e=!1){if(!this.canReaddir()){e?t(null,[]):queueMicrotask(()=>t(null,[]));return}let s=this.children();if(this.calledReaddir()){let r=s.slice(0,s.provisional);e?t(null,r):queueMicrotask(()=>t(null,r));return}if(this.#Q.push(t),this.#V)return;this.#V=!0;let n=this.fullpath();this.#t.readdir(n,{withFileTypes:!0},(r,o)=>{if(r)this.#M(r.code),s.provisional=0;else{for(let a of o)this.#z(a,s);this.#F(s)}this.#X(s.slice(0,s.provisional))})}#_;async readdir(){if(!this.canReaddir())return[];let t=this.children();if(this.calledReaddir())return t.slice(0,t.provisional);let e=this.fullpath();if(this.#_)await this.#_;else{let s=()=>{};this.#_=new Promise(n=>s=n);try{for(let n of await this.#t.promises.readdir(e,{withFileTypes:!0}))this.#z(n,t);this.#F(t)}catch(n){this.#M(n.code),t.provisional=0}this.#_=void 0,s()}return t.slice(0,t.provisional)}readdirSync(){if(!this.canReaddir())return[];let t=this.children();if(this.calledReaddir())return t.slice(0,t.provisional);let e=this.fullpath();try{for(let s of this.#t.readdirSync(e,{withFileTypes:!0}))this.#z(s,t);this.#F(t)}catch(s){this.#M(s.code),t.provisional=0}return t.slice(0,t.provisional)}canReaddir(){if(this.#i&_s)return!1;let t=K&this.#i;return t===tt||t===pt||t===Nt}shouldWalk(t,e){return(this.#i&pt)===pt&&!(this.#i&_s)&&!t.has(this)&&(!e||e(this))}async realpath(){if(this.#R)return this.#R;if(!((Xe|Ve|lt)&this.#i))try{let t=await this.#t.promises.realpath(this.fullpath());return this.#R=this.resolve(t)}catch{this.#T()}}realpathSync(){if(this.#R)return this.#R;if(!((Xe|Ve|lt)&this.#i))try{let t=this.#t.realpathSync(this.fullpath());return this.#R=this.resolve(t)}catch{this.#T()}}[Ks](t){if(t===this)return;t.isCWD=!1,this.isCWD=!0;let e=new Set([]),s=[],n=this;for(;n&&n.parent;)e.add(n),n.#I=s.join(this.sep),n.#C=s.join("/"),n=n.parent,s.push("..");for(n=t;n&&n.parent&&!e.has(n);)n.#I=void 0,n.#C=void 0,n=n.parent}},Ge=class i extends z{sep="\\";splitSep=ko;constructor(t,e=tt,s,n,r,o,a){super(t,e,s,n,r,o,a)}newChild(t,e=tt,s={}){return new i(t,e,this.root,this.roots,this.nocase,this.childrenCache(),s)}getRootString(t){return $t.win32.parse(t).root}getRoot(t){if(t=wo(t.toUpperCase()),t===this.root.name)return this.root;for(let[e,s]of Object.entries(this.roots))if(this.sameRoot(t,e))return this.roots[t]=s;return this.roots[t]=new Xt(t,this).root}sameRoot(t,e=this.root.name){return t=t.toUpperCase().replace(/\//g,"\\").replace(Hs,"$1\\"),t===e}},Ze=class i extends z{splitSep="/";sep="/";constructor(t,e=tt,s,n,r,o,a){super(t,e,s,n,r,o,a)}getRootString(t){return t.startsWith("/")?"/":""}getRoot(t){return this.root}newChild(t,e=tt,s={}){return new i(t,e,this.root,this.roots,this.nocase,this.childrenCache(),s)}},qe=class{root;rootPath;roots;cwd;#t;#e;#r;nocase;#s;constructor(t=process.cwd(),e,s,{nocase:n,childrenCacheSize:r=16*1024,fs:o=ge}={}){this.#s=Xs(o),(t instanceof URL||t.startsWith("file://"))&&(t=(0,$s.fileURLToPath)(t));let a=e.resolve(t);this.roots=Object.create(null),this.rootPath=this.parseRootPath(a),this.#t=new He,this.#e=new He,this.#r=new Ci(r);let l=a.substring(this.rootPath.length).split(s);if(l.length===1&&!l[0]&&l.pop(),n===void 0)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=n,this.root=this.newRoot(this.#s),this.roots[this.rootPath]=this.root;let c=this.root,h=l.length-1,u=e.sep,d=this.rootPath,f=!1;for(let b of l){let p=h--;c=c.child(b,{relative:new Array(p).fill("..").join(u),relativePosix:new Array(p).fill("..").join("/"),fullpath:d+=(f?"":u)+b}),f=!0}this.cwd=c}depth(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.depth()}childrenCache(){return this.#r}resolve(...t){let e="";for(let r=t.length-1;r>=0;r--){let o=t[r];if(!(!o||o===".")&&(e=e?`${o}/${e}`:o,this.isAbsolute(o)))break}let s=this.#t.get(e);if(s!==void 0)return s;let n=this.cwd.resolve(e).fullpath();return this.#t.set(e,n),n}resolvePosix(...t){let e="";for(let r=t.length-1;r>=0;r--){let o=t[r];if(!(!o||o===".")&&(e=e?`${o}/${e}`:o,this.isAbsolute(o)))break}let s=this.#e.get(e);if(s!==void 0)return s;let n=this.cwd.resolve(e).fullpathPosix();return this.#e.set(e,n),n}relative(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.relative()}relativePosix(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.relativePosix()}basename(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.name}dirname(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),(t.parent||t).fullpath()}async readdir(t=this.cwd,e={withFileTypes:!0}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd);let{withFileTypes:s}=e;if(t.canReaddir()){let n=await t.readdir();return s?n:n.map(r=>r.name)}else return[]}readdirSync(t=this.cwd,e={withFileTypes:!0}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd);let{withFileTypes:s=!0}=e;return t.canReaddir()?s?t.readdirSync():t.readdirSync().map(n=>n.name):[]}async lstat(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.lstat()}lstatSync(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.lstatSync()}async readlink(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t.withFileTypes,t=this.cwd);let s=await t.readlink();return e?s:s?.fullpath()}readlinkSync(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t.withFileTypes,t=this.cwd);let s=t.readlinkSync();return e?s:s?.fullpath()}async realpath(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t.withFileTypes,t=this.cwd);let s=await t.realpath();return e?s:s?.fullpath()}realpathSync(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t.withFileTypes,t=this.cwd);let s=t.realpathSync();return e?s:s?.fullpath()}async walk(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:n=!1,filter:r,walkFilter:o}=e,a=[];(!r||r(t))&&a.push(s?t:t.fullpath());let l=new Set,c=(u,d)=>{l.add(u),u.readdirCB((f,b)=>{if(f)return d(f);let p=b.length;if(!p)return d();let k=()=>{--p===0&&d()};for(let A of b)(!r||r(A))&&a.push(s?A:A.fullpath()),n&&A.isSymbolicLink()?A.realpath().then(S=>S?.isUnknown()?S.lstat():S).then(S=>S?.shouldWalk(l,o)?c(S,k):k()):A.shouldWalk(l,o)?c(A,k):k()},!0)},h=t;return new Promise((u,d)=>{c(h,f=>{if(f)return d(f);u(a)})})}walkSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:n=!1,filter:r,walkFilter:o}=e,a=[];(!r||r(t))&&a.push(s?t:t.fullpath());let l=new Set([t]);for(let c of l){let h=c.readdirSync();for(let u of h){(!r||r(u))&&a.push(s?u:u.fullpath());let d=u;if(u.isSymbolicLink()){if(!(n&&(d=u.realpathSync())))continue;d.isUnknown()&&d.lstatSync()}d.shouldWalk(l,o)&&l.add(d)}}return a}[Symbol.asyncIterator](){return this.iterate()}iterate(t=this.cwd,e={}){return typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd),this.stream(t,e)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:n=!1,filter:r,walkFilter:o}=e;(!r||r(t))&&(yield s?t:t.fullpath());let a=new Set([t]);for(let l of a){let c=l.readdirSync();for(let h of c){(!r||r(h))&&(yield s?h:h.fullpath());let u=h;if(h.isSymbolicLink()){if(!(n&&(u=h.realpathSync())))continue;u.isUnknown()&&u.lstatSync()}u.shouldWalk(a,o)&&a.add(u)}}}stream(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:n=!1,filter:r,walkFilter:o}=e,a=new Tt({objectMode:!0});(!r||r(t))&&a.write(s?t:t.fullpath());let l=new Set,c=[t],h=0,u=()=>{let d=!1;for(;!d;){let f=c.shift();if(!f){h===0&&a.end();return}h++,l.add(f);let b=(k,A,S=!1)=>{if(k)return a.emit("error",k);if(n&&!S){let v=[];for(let y of A)y.isSymbolicLink()&&v.push(y.realpath().then(x=>x?.isUnknown()?x.lstat():x));if(v.length){Promise.all(v).then(()=>b(null,A,!0));return}}for(let v of A)v&&(!r||r(v))&&(a.write(s?v:v.fullpath())||(d=!0));h--;for(let v of A){let y=v.realpathCached()||v;y.shouldWalk(l,o)&&c.push(y)}d&&!a.flowing?a.once("drain",u):p||u()},p=!0;f.readdirCB(b,!0),p=!1}};return u(),a}streamSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof z||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:n=!1,filter:r,walkFilter:o}=e,a=new Tt({objectMode:!0}),l=new Set;(!r||r(t))&&a.write(s?t:t.fullpath());let c=[t],h=0,u=()=>{let d=!1;for(;!d;){let f=c.shift();if(!f){h===0&&a.end();return}h++,l.add(f);let b=f.readdirSync();for(let p of b)(!r||r(p))&&(a.write(s?p:p.fullpath())||(d=!0));h--;for(let p of b){let k=p;if(p.isSymbolicLink()){if(!(n&&(k=p.realpathSync())))continue;k.isUnknown()&&k.lstatSync()}k.shouldWalk(l,o)&&c.push(k)}}d&&!a.flowing&&a.once("drain",u)};return u(),a}chdir(t=this.cwd){let e=this.cwd;this.cwd=typeof t=="string"?this.cwd.resolve(t):t,this.cwd[Ks](e)}},Xt=class extends qe{sep="\\";constructor(t=process.cwd(),e={}){let{nocase:s=!0}=e;super(t,$t.win32,"\\",{...e,nocase:s}),this.nocase=s;for(let n=this.cwd;n;n=n.parent)n.nocase=this.nocase}parseRootPath(t){return $t.win32.parse(t).root.toUpperCase()}newRoot(t){return new Ge(this.rootPath,pt,void 0,this.roots,this.nocase,this.childrenCache(),{fs:t})}isAbsolute(t){return t.startsWith("/")||t.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(t)}},Ht=class extends qe{sep="/";constructor(t=process.cwd(),e={}){let{nocase:s=!1}=e;super(t,$t.posix,"/",{...e,nocase:s}),this.nocase=s}parseRootPath(t){return"/"}newRoot(t){return new Ze(this.rootPath,pt,void 0,this.roots,this.nocase,this.childrenCache(),{fs:t})}isAbsolute(t){return t.startsWith("/")}},we=class extends Ht{constructor(t=process.cwd(),e={}){let{nocase:s=!0}=e;super(t,{...e,nocase:s})}},Ya=process.platform==="win32"?Ge:Ze,tn=process.platform==="win32"?Xt:process.platform==="darwin"?we:Ht;var vo=i=>i.length>=1,So=i=>i.length>=1,Gt=class i{#t;#e;#r;length;#s;#o;#k;#c;#u;#a;#l=!0;constructor(t,e,s,n){if(!vo(t))throw new TypeError("empty pattern list");if(!So(e))throw new TypeError("empty glob list");if(e.length!==t.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=t.length,s<0||s>=this.length)throw new TypeError("index out of range");if(this.#t=t,this.#e=e,this.#r=s,this.#s=n,this.#r===0){if(this.isUNC()){let[r,o,a,l,...c]=this.#t,[h,u,d,f,...b]=this.#e;c[0]===""&&(c.shift(),b.shift());let p=[r,o,a,l,""].join("/"),k=[h,u,d,f,""].join("/");this.#t=[p,...c],this.#e=[k,...b],this.length=this.#t.length}else if(this.isDrive()||this.isAbsolute()){let[r,...o]=this.#t,[a,...l]=this.#e;o[0]===""&&(o.shift(),l.shift());let c=r+"/",h=a+"/";this.#t=[c,...o],this.#e=[h,...l],this.length=this.#t.length}}}pattern(){return this.#t[this.#r]}isString(){return typeof this.#t[this.#r]=="string"}isGlobstar(){return this.#t[this.#r]===U}isRegExp(){return this.#t[this.#r]instanceof RegExp}globString(){return this.#k=this.#k||(this.#r===0?this.isAbsolute()?this.#e[0]+this.#e.slice(1).join("/"):this.#e.join("/"):this.#e.slice(this.#r).join("/"))}hasMore(){return this.length>this.#r+1}rest(){return this.#o!==void 0?this.#o:this.hasMore()?(this.#o=new i(this.#t,this.#e,this.#r+1,this.#s),this.#o.#a=this.#a,this.#o.#u=this.#u,this.#o.#c=this.#c,this.#o):this.#o=null}isUNC(){let t=this.#t;return this.#u!==void 0?this.#u:this.#u=this.#s==="win32"&&this.#r===0&&t[0]===""&&t[1]===""&&typeof t[2]=="string"&&!!t[2]&&typeof t[3]=="string"&&!!t[3]}isDrive(){let t=this.#t;return this.#c!==void 0?this.#c:this.#c=this.#s==="win32"&&this.#r===0&&this.length>1&&typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0])}isAbsolute(){let t=this.#t;return this.#a!==void 0?this.#a:this.#a=t[0]===""&&t.length>1||this.isDrive()||this.isUNC()}root(){let t=this.#t[0];return typeof t=="string"&&this.isAbsolute()&&this.#r===0?t:""}checkFollowGlobstar(){return!(this.#r===0||!this.isGlobstar()||!this.#l)}markFollowGlobstar(){return this.#r===0||!this.isGlobstar()||!this.#l?!1:(this.#l=!1,!0)}};var Eo=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",Zt=class{relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(t,{nobrace:e,nocase:s,noext:n,noglobstar:r,platform:o=Eo}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=o,this.mmopts={dot:!0,nobrace:e,nocase:s,noext:n,noglobstar:r,optimizationLevel:2,platform:o,nocomment:!0,nonegate:!0};for(let a of t)this.add(a)}add(t){let e=new $(t,this.mmopts);for(let s=0;s<e.set.length;s++){let n=e.set[s],r=e.globParts[s];if(!n||!r)throw new Error("invalid pattern object");for(;n[0]==="."&&r[0]===".";)n.shift(),r.shift();let o=new Gt(n,r,0,this.platform),a=new $(o.globString(),this.mmopts),l=r[r.length-1]==="**",c=o.isAbsolute();c?this.absolute.push(a):this.relative.push(a),l&&(c?this.absoluteChildren.push(a):this.relativeChildren.push(a))}}ignored(t){let e=t.fullpath(),s=`${e}/`,n=t.relative()||".",r=`${n}/`;for(let o of this.relative)if(o.match(n)||o.match(r))return!0;for(let o of this.absolute)if(o.match(e)||o.match(s))return!0;return!1}childrenIgnored(t){let e=t.fullpath()+"/",s=(t.relative()||".")+"/";for(let n of this.relativeChildren)if(n.match(s))return!0;for(let n of this.absoluteChildren)if(n.match(e))return!0;return!1}};var Bi=class i{store;constructor(t=new Map){this.store=t}copy(){return new i(new Map(this.store))}hasWalked(t,e){return this.store.get(t.fullpath())?.has(e.globString())}storeWalked(t,e){let s=t.fullpath(),n=this.store.get(s);n?n.add(e.globString()):this.store.set(s,new Set([e.globString()]))}},Ti=class{store=new Map;add(t,e,s){let n=(e?2:0)|(s?1:0),r=this.store.get(t);this.store.set(t,r===void 0?n:n&r)}entries(){return[...this.store.entries()].map(([t,e])=>[t,!!(e&2),!!(e&1)])}},Ii=class{store=new Map;add(t,e){if(!t.canReaddir())return;let s=this.store.get(t);s?s.find(n=>n.globString()===e.globString())||s.push(e):this.store.set(t,[e])}get(t){let e=this.store.get(t);if(!e)throw new Error("attempting to walk unknown path");return e}entries(){return this.keys().map(t=>[t,this.store.get(t)])}keys(){return[...this.store.keys()].filter(t=>t.canReaddir())}},ke=class i{hasWalkedCache;matches=new Ti;subwalks=new Ii;patterns;follow;dot;opts;constructor(t,e){this.opts=t,this.follow=!!t.follow,this.dot=!!t.dot,this.hasWalkedCache=e?e.copy():new Bi}processPatterns(t,e){this.patterns=e;let s=e.map(n=>[t,n]);for(let[n,r]of s){this.hasWalkedCache.storeWalked(n,r);let o=r.root(),a=r.isAbsolute()&&this.opts.absolute!==!1;if(o){n=n.resolve(o==="/"&&this.opts.root!==void 0?this.opts.root:o);let u=r.rest();if(u)r=u;else{this.matches.add(n,!0,!1);continue}}if(n.isENOENT())continue;let l,c,h=!1;for(;typeof(l=r.pattern())=="string"&&(c=r.rest());)n=n.resolve(l),r=c,h=!0;if(l=r.pattern(),c=r.rest(),h){if(this.hasWalkedCache.hasWalked(n,r))continue;this.hasWalkedCache.storeWalked(n,r)}if(typeof l=="string"){let u=l===".."||l===""||l===".";this.matches.add(n.resolve(l),a,u);continue}else if(l===U){(!n.isSymbolicLink()||this.follow||r.checkFollowGlobstar())&&this.subwalks.add(n,r);let u=c?.pattern(),d=c?.rest();if(!c||(u===""||u===".")&&!d)this.matches.add(n,a,u===""||u===".");else if(u===".."){let f=n.parent||n;d?this.hasWalkedCache.hasWalked(f,d)||this.subwalks.add(f,d):this.matches.add(f,a,!0)}}else l instanceof RegExp&&this.subwalks.add(n,r)}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new i(this.opts,this.hasWalkedCache)}filterEntries(t,e){let s=this.subwalks.get(t),n=this.child();for(let r of e)for(let o of s){let a=o.isAbsolute(),l=o.pattern(),c=o.rest();l===U?n.testGlobstar(r,o,c,a):l instanceof RegExp?n.testRegExp(r,l,c,a):n.testString(r,l,c,a)}return n}testGlobstar(t,e,s,n){if((this.dot||!t.name.startsWith("."))&&(e.hasMore()||this.matches.add(t,n,!1),t.canReaddir()&&(this.follow||!t.isSymbolicLink()?this.subwalks.add(t,e):t.isSymbolicLink()&&(s&&e.checkFollowGlobstar()?this.subwalks.add(t,s):e.markFollowGlobstar()&&this.subwalks.add(t,e)))),s){let r=s.pattern();if(typeof r=="string"&&r!==".."&&r!==""&&r!==".")this.testString(t,r,s.rest(),n);else if(r===".."){let o=t.parent||t;this.subwalks.add(o,s)}else r instanceof RegExp&&this.testRegExp(t,r,s.rest(),n)}}testRegExp(t,e,s,n){e.test(t.name)&&(s?this.subwalks.add(t,s):this.matches.add(t,n,!1))}testString(t,e,s,n){t.isNamed(e)&&(s?this.subwalks.add(t,s):this.matches.add(t,n,!1))}};var xo=(i,t)=>typeof i=="string"?new Zt([i],t):Array.isArray(i)?new Zt(i,t):i,Ye=class{path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#t=[];#e;#r;signal;maxDepth;includeChildMatches;constructor(t,e,s){if(this.patterns=t,this.path=e,this.opts=s,this.#r=!s.posix&&s.platform==="win32"?"\\":"/",this.includeChildMatches=s.includeChildMatches!==!1,(s.ignore||!this.includeChildMatches)&&(this.#e=xo(s.ignore??[],s),!this.includeChildMatches&&typeof this.#e.add!="function")){let n="cannot ignore child matches, ignore lacks add() method.";throw new Error(n)}this.maxDepth=s.maxDepth||1/0,s.signal&&(this.signal=s.signal,this.signal.addEventListener("abort",()=>{this.#t.length=0}))}#s(t){return this.seen.has(t)||!!this.#e?.ignored?.(t)}#o(t){return!!this.#e?.childrenIgnored?.(t)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;this.paused=!1;let t;for(;!this.paused&&(t=this.#t.shift());)t()}onResume(t){this.signal?.aborted||(this.paused?this.#t.push(t):t())}async matchCheck(t,e){if(e&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=t.realpathCached()||await t.realpath(),!s)return;t=s}let r=t.isUnknown()||this.opts.stat?await t.lstat():t;if(this.opts.follow&&this.opts.nodir&&r?.isSymbolicLink()){let o=await r.realpath();o&&(o.isUnknown()||this.opts.stat)&&await o.lstat()}return this.matchCheckTest(r,e)}matchCheckTest(t,e){return t&&(this.maxDepth===1/0||t.depth()<=this.maxDepth)&&(!e||t.canReaddir())&&(!this.opts.nodir||!t.isDirectory())&&(!this.opts.nodir||!this.opts.follow||!t.isSymbolicLink()||!t.realpathCached()?.isDirectory())&&!this.#s(t)?t:void 0}matchCheckSync(t,e){if(e&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=t.realpathCached()||t.realpathSync(),!s)return;t=s}let r=t.isUnknown()||this.opts.stat?t.lstatSync():t;if(this.opts.follow&&this.opts.nodir&&r?.isSymbolicLink()){let o=r.realpathSync();o&&(o?.isUnknown()||this.opts.stat)&&o.lstatSync()}return this.matchCheckTest(r,e)}matchFinish(t,e){if(this.#s(t))return;if(!this.includeChildMatches&&this.#e?.add){let r=`${t.relativePosix()}/**`;this.#e.add(r)}let s=this.opts.absolute===void 0?e:this.opts.absolute;this.seen.add(t);let n=this.opts.mark&&t.isDirectory()?this.#r:"";if(this.opts.withFileTypes)this.matchEmit(t);else if(s){let r=this.opts.posix?t.fullpathPosix():t.fullpath();this.matchEmit(r+n)}else{let r=this.opts.posix?t.relativePosix():t.relative(),o=this.opts.dotRelative&&!r.startsWith(".."+this.#r)?"."+this.#r:"";this.matchEmit(r?o+r+n:"."+n)}}async match(t,e,s){let n=await this.matchCheck(t,s);n&&this.matchFinish(n,e)}matchSync(t,e,s){let n=this.matchCheckSync(t,s);n&&this.matchFinish(n,e)}walkCB(t,e,s){this.signal?.aborted&&s(),this.walkCB2(t,e,new ke(this.opts),s)}walkCB2(t,e,s,n){if(this.#o(t))return n();if(this.signal?.aborted&&n(),this.paused){this.onResume(()=>this.walkCB2(t,e,s,n));return}s.processPatterns(t,e);let r=1,o=()=>{--r===0&&n()};for(let[a,l,c]of s.matches.entries())this.#s(a)||(r++,this.match(a,l,c).then(()=>o()));for(let a of s.subwalkTargets()){if(this.maxDepth!==1/0&&a.depth()>=this.maxDepth)continue;r++;let l=a.readdirCached();a.calledReaddir()?this.walkCB3(a,l,s,o):a.readdirCB((c,h)=>this.walkCB3(a,h,s,o),!0)}o()}walkCB3(t,e,s,n){s=s.filterEntries(t,e);let r=1,o=()=>{--r===0&&n()};for(let[a,l,c]of s.matches.entries())this.#s(a)||(r++,this.match(a,l,c).then(()=>o()));for(let[a,l]of s.subwalks.entries())r++,this.walkCB2(a,l,s.child(),o);o()}walkCBSync(t,e,s){this.signal?.aborted&&s(),this.walkCB2Sync(t,e,new ke(this.opts),s)}walkCB2Sync(t,e,s,n){if(this.#o(t))return n();if(this.signal?.aborted&&n(),this.paused){this.onResume(()=>this.walkCB2Sync(t,e,s,n));return}s.processPatterns(t,e);let r=1,o=()=>{--r===0&&n()};for(let[a,l,c]of s.matches.entries())this.#s(a)||this.matchSync(a,l,c);for(let a of s.subwalkTargets()){if(this.maxDepth!==1/0&&a.depth()>=this.maxDepth)continue;r++;let l=a.readdirSync();this.walkCB3Sync(a,l,s,o)}o()}walkCB3Sync(t,e,s,n){s=s.filterEntries(t,e);let r=1,o=()=>{--r===0&&n()};for(let[a,l,c]of s.matches.entries())this.#s(a)||this.matchSync(a,l,c);for(let[a,l]of s.subwalks.entries())r++,this.walkCB2Sync(a,l,s.child(),o);o()}},ye=class extends Ye{matches=new Set;constructor(t,e,s){super(t,e,s)}matchEmit(t){this.matches.add(t)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise((t,e)=>{this.walkCB(this.path,this.patterns,()=>{this.signal?.aborted?e(this.signal.reason):t(this.matches)})}),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>{if(this.signal?.aborted)throw this.signal.reason}),this.matches}},ve=class extends Ye{results;constructor(t,e,s){super(t,e,s),this.results=new Tt({signal:this.signal,objectMode:!0}),this.results.on("drain",()=>this.resume()),this.results.on("resume",()=>this.resume())}matchEmit(t){this.results.write(t),this.results.flowing||this.pause()}stream(){let t=this.path;return t.isUnknown()?t.lstat().then(()=>{this.walkCB(t,this.patterns,()=>this.results.end())}):this.walkCB(t,this.patterns,()=>this.results.end()),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>this.results.end()),this.results}};var Co=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",ct=class{absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;includeChildMatches;opts;patterns;constructor(t,e){if(!e)throw new TypeError("glob options required");if(this.withFileTypes=!!e.withFileTypes,this.signal=e.signal,this.follow=!!e.follow,this.dot=!!e.dot,this.dotRelative=!!e.dotRelative,this.nodir=!!e.nodir,this.mark=!!e.mark,e.cwd?(e.cwd instanceof URL||e.cwd.startsWith("file://"))&&(e.cwd=(0,en.fileURLToPath)(e.cwd)):this.cwd="",this.cwd=e.cwd||"",this.root=e.root,this.magicalBraces=!!e.magicalBraces,this.nobrace=!!e.nobrace,this.noext=!!e.noext,this.realpath=!!e.realpath,this.absolute=e.absolute,this.includeChildMatches=e.includeChildMatches!==!1,this.noglobstar=!!e.noglobstar,this.matchBase=!!e.matchBase,this.maxDepth=typeof e.maxDepth=="number"?e.maxDepth:1/0,this.stat=!!e.stat,this.ignore=e.ignore,this.withFileTypes&&this.absolute!==void 0)throw new Error("cannot set absolute and withFileTypes:true");if(typeof t=="string"&&(t=[t]),this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||e.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(t=t.map(l=>l.replace(/\\/g,"/"))),this.matchBase){if(e.noglobstar)throw new TypeError("base matching requires globstar");t=t.map(l=>l.includes("/")?l:`./**/${l}`)}if(this.pattern=t,this.platform=e.platform||Co,this.opts={...e,platform:this.platform},e.scurry){if(this.scurry=e.scurry,e.nocase!==void 0&&e.nocase!==e.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else{let l=e.platform==="win32"?Xt:e.platform==="darwin"?we:e.platform?Ht:tn;this.scurry=new l(this.cwd,{nocase:e.nocase,fs:e.fs})}this.nocase=this.scurry.nocase;let s=this.platform==="darwin"||this.platform==="win32",n={...e,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:s,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},r=this.pattern.map(l=>new $(l,n)),[o,a]=r.reduce((l,c)=>(l[0].push(...c.set),l[1].push(...c.globParts),l),[[],[]]);this.patterns=o.map((l,c)=>{let h=a[c];if(!h)throw new Error("invalid pattern object");return new Gt(l,h,0,this.platform)})}async walk(){return[...await new ye(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walk()]}walkSync(){return[...new ye(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walkSync()]}stream(){return new ve(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).stream()}streamSync(){return new ve(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}};var Ri=(i,t={})=>{Array.isArray(i)||(i=[i]);for(let e of i)if(new $(e,t).hasMagic())return!0;return!1};function Je(i,t={}){return new ct(i,t).streamSync()}function rn(i,t={}){return new ct(i,t).stream()}function Se(i,t={}){return new ct(i,t).walkSync()}async function sn(i,t={}){return new ct(i,t).walk()}function Ke(i,t={}){return new ct(i,t).iterateSync()}function on(i,t={}){return new ct(i,t).iterate()}var Bo=Je,To=Object.assign(rn,{sync:Je}),Io=Ke,Ro=Object.assign(on,{sync:Ke}),Oo=Object.assign(Se,{stream:Je,iterate:Ke}),nn=Object.assign(sn,{glob:sn,globSync:Se,sync:Oo,globStream:rn,stream:To,globStreamSync:Je,streamSync:Bo,globIterate:on,iterate:Ro,globIterateSync:Ke,iterateSync:Io,Glob:ct,hasMagic:Ri,escape:xt,unescape:ot});nn.glob=nn;var et=(i,t,e)=>e.indexOf(i)===t;var an=require("os"),Ee=require("vscode");var Do=(0,an.homedir)(),ln=i=>{ti||(ti=i.replace(/\/$/,""))},ti,Oi=i=>i.replace(/\${(.*?)}/g,(t,e)=>e==="vscode:workspace"&&Ee.workspace.workspaceFolders&&Ee.workspace.workspaceFolders.length>0&&Ee.workspace.workspaceFolders[0].uri?qt(Ee.workspace.workspaceFolders[0].uri.fsPath.toString()):e==="vscode:user"&&ti?qt(ti):e==="user:home"?qt(Do):e in process.env?qt(process.env[e]||""):"");var hn=i=>{let t=(0,cn.extname)(i).slice(1);return ei().includes(t)},un={absolute:!0,nodir:!0},Di=i=>qt(i.fsPath),qt=i=>xt(i.replace(/\\/g,"/")),Yt=i=>{let t=0,e=[];for(let s of Array.isArray(i)?i.filter(et):[i])s.startsWith("https://")?t++:e.push(Oi(s));return t+Se(e,un).filter(hn).filter(et).length},xe=i=>{let t=[],e=[];for(let s of Array.isArray(i)?i.filter(et):[i])s.startsWith("https://")?t.push(s):e.push(Oi(s));return t.concat(Se(e,un).filter(hn).map(s=>`vscode-file://vscode-app/${s.replace(/\\/g,"/").replace(/^\/+/g,"")}`)).filter(et).map(s=>'"'+s.replace(/"/g,'\\"')+'"')};var yt="KatsuteDev/Background",Po=new RegExp(`^\\/\\* ${yt}-start \\*\\/$[\\s\\S]*?^\\/\\* ${yt}-end \\*\\/$`,"gmi"),ei=()=>["png","jpg","jpeg","webp","gif","bmp","svg"],dn=i=>Pi(i)+`
/* ${yt}-start */
`+No(Fo())+`
/* ${yt}-end */`,Pi=i=>i.replace(Po,"").trim(),Fo=()=>{let i={window:xe(m("windowBackgrounds")),editor:xe(m("editorBackgrounds")),sidebar:xe(m("sidebarBackgrounds")),panel:xe(m("panelBackgrounds"))},t=m("renderContentAboveBackground");return`(() => {
const bk_global = document.createElement("style");
bk_global.id = "${yt}-global";
bk_global.setAttribute("type", "text/css");

bk_global.appendChild(document.createTextNode(\`

    body[windowTransition="true"]${t?" > div[role=application] > div.monaco-grid-view::after":"::before"},
    body[editorTransition="true"] .split-view-view > .editor-group-container::after,
    body[sidebarTransition="true"] .split-view-view > .part.sidebar::after,
    body[sidebarTransition="true"] .split-view-view > .part.auxiliarybar::after,
    body[panelTransition="true"] .split-view-view > .part.panel::after {

        opacity: 0;

    }

    body${t?" > div[role=application] > div.monaco-grid-view::after":"::before"},
    .split-view-view > .editor-group-container::after,
    .split-view-view > .part.sidebar::after,
    .split-view-view > .part.auxiliarybar::after,
    .split-view-view > .part.panel::after {

        content: "";

        top: 0;

        width: 100%;
        height: 100%;

        ${t?"":"z-index: 1000;"}

        position: absolute;

        pointer-events: none;

        transition: opacity 1s ease-in-out;

        image-rendering: ${m("smoothImageRendering")?"auto":"pixelated"};

    }
\`));

const windowBackgrounds = [${i.window.join(",")}];
const editorBackgrounds = [${i.editor.join(",")}];
const sidebarBackgrounds = [${i.sidebar.join(",")}];
const panelBackgrounds = [${i.panel.join(",")}];

const iWindowBackgrounds = [...Array(${i.window.length}).keys()];
const iEditorBackgrounds = [...Array(${i.editor.length}).keys()];
const iSidebarBackgrounds = [...Array(${i.sidebar.length}).keys()];
const iPanelBackgrounds = [...Array(${i.panel.length}).keys()];

const windowTime = ${m("backgroundChangeTime",{ui:"window"})===0?0:Math.max(N(m("backgroundChangeTime",{ui:"window"}),2),5)};
const editorTime = ${m("backgroundChangeTime",{ui:"editor"})===0?0:Math.max(N(m("backgroundChangeTime",{ui:"editor"}),2),5)};
const sidebarTime = ${m("backgroundChangeTime",{ui:"sidebar"})===0?0:Math.max(N(m("backgroundChangeTime",{ui:"sidebar"}),2),5)};
const panelTime = ${m("backgroundChangeTime",{ui:"panel"})===0?0:Math.max(N(m("backgroundChangeTime",{ui:"panel"}),2),5)};

if(windowBackgrounds.length > 0){
    bk_global.appendChild(document.createTextNode(\`
        body${t?" > div[role=application] > div.monaco-grid-view::after":"::before"} {

            background-position: ${C("backgroundAlignment","window")};
            background-repeat: ${C("backgroundRepeat","window")};
            background-size: ${C("backgroundSize","window")};

            opacity: ${N(m("useInvertedOpacity")?1-+C("backgroundOpacity","window"):+C("backgroundOpacity","window"),2)};

            filter: blur(${C("backgroundBlur","window")});

        }
    \`));
};

if(editorBackgrounds.length > 0){
    bk_global.appendChild(document.createTextNode(\`
        .split-view-view > .editor-group-container::after {

            background-position: ${C("backgroundAlignment","editor")};
            background-repeat: ${C("backgroundRepeat","editor")};
            background-size: ${C("backgroundSize","editor")};

            opacity: ${N(m("useInvertedOpacity")?1-+C("backgroundOpacity","editor"):+C("backgroundOpacity","editor"),2)};

            filter: blur(${C("backgroundBlur","editor")});

        }
    \`));
};

if(sidebarBackgrounds.length > 0){
    bk_global.appendChild(document.createTextNode(\`
        .split-view-view > .part.sidebar::after,
        .split-view-view > .part.auxiliarybar::after {

            background-position: ${C("backgroundAlignment","sidebar")};
            background-repeat: ${C("backgroundRepeat","sidebar")};
            background-size: ${C("backgroundSize","sidebar")};

            opacity: ${N(m("useInvertedOpacity")?1-+C("backgroundOpacity","sidebar"):+C("backgroundOpacity","sidebar"),2)};

            filter: blur(${C("backgroundBlur","sidebar")});

        }
    \`));
};

if(panelBackgrounds.length > 0){
    bk_global.appendChild(document.createTextNode(\`
        .split-view-view > .part.panel::after {

            background-position: ${C("backgroundAlignment","panel")};
            background-repeat: ${C("backgroundRepeat","panel")};
            background-size: ${C("backgroundSize","panel")};

            opacity: ${N(m("useInvertedOpacity")?1-+C("backgroundOpacity","panel"):+C("backgroundOpacity","panel"),2)};

            filter: blur(${C("backgroundBlur","panel")});

        }
    \`));
};

bk_global.appendChild(document.createTextNode(\`
    div.notification-toast:has(> div.notifications-list-container > div.monaco-list[aria-label="Your Code installation appears to be corrupt. Please reinstall., notification"]),
    div.notification-toast:has(> div.notifications-list-container > div.monaco-list[aria-label="Your Code - Insiders installation appears to be corrupt. Please reinstall., notification"]) {

        display: none;

    }

    div.monaco-list-row[aria-label$=", source: Background (Extension), notification"],
    div.monaco-list-row[aria-label$=", source: Background (Extension), notification"]:hover {

        background-color: #0098FF !important;
        color: white !important;

    }

    div.monaco-list-row[aria-label$=", source: Background (Extension), notification"] ::before {

        color: white;

    }
\`));

bk_global.appendChild(document.createTextNode("${rs(m("CSS"))}"));

const bk_window_image = document.createElement("style");
bk_window_image.id = "${yt}-window-images";
bk_window_image.setAttribute("type", "text/css");

const setWindowBackground = () => {
    while(bk_window_image.firstChild){
        bk_window_image.removeChild(bk_window_image.firstChild);
    };

    if(windowBackgrounds.length > 0){
        shuffle(iWindowBackgrounds);

        bk_window_image.appendChild(document.createTextNode(\`
            body${t?" > div[role=application] > div.monaco-grid-view::after":"::before"} {

                background-image: url("\${windowBackgrounds[iWindowBackgrounds[0]].replace(/"/g, \`\\\\"\`)}");

            }
        \`));
    };
};

const bk_editor_image = document.createElement("style");
bk_editor_image.id = "${yt}-editor-images";
bk_editor_image.setAttribute("type", "text/css");

const setEditorBackground = () => {
    while(bk_editor_image.firstChild){
        bk_editor_image.removeChild(bk_editor_image.firstChild);
    };

    if(editorBackgrounds.length > 0){
        const len = Math.min(editorBackgrounds.length, 10);

        shuffle(iEditorBackgrounds);

        let buf = '';
        for(let i = 0; i < len; i++){
            buf += \`
                .part.editor :not(.split-view-container) .split-view-container > .split-view-view:nth-child(\${len}n+\${i+1}) > .editor-group-container::after {
                    background-image: url("\${editorBackgrounds[iEditorBackgrounds[i]].replace(/"/g, \`\\\\"\`)}");
                }
            \`;
        };
        bk_editor_image.appendChild(document.createTextNode(buf));
    };
};

const bk_sidebar_image = document.createElement("style");
bk_sidebar_image.id = "${yt}-sidebar-images";
bk_sidebar_image.setAttribute("type", "text/css");

const setSidebarBackground = () => {
    while(bk_sidebar_image.firstChild){
        bk_sidebar_image.removeChild(bk_sidebar_image.firstChild);
    };

    if(sidebarBackgrounds.length > 0){
        shuffle(iSidebarBackgrounds);

        bk_sidebar_image.appendChild(document.createTextNode(\`
            .split-view-view > .part.sidebar::after {

                background-image: url("\${sidebarBackgrounds[iSidebarBackgrounds[0]].replace(/"/g, \`\\\\"\`)}");

            }
            .split-view-view > .part.auxiliarybar::after {

                background-image: url("\${(sidebarBackgrounds[iSidebarBackgrounds[1]] ?? sidebarBackgrounds[iSidebarBackgrounds[0]]).replace(/"/g, \`\\\\"\`)}");

            }
        \`));
    };
};

const bk_panel_image = document.createElement("style");
bk_panel_image.id = "${yt}-panel-images";
bk_panel_image.setAttribute("type", "text/css");

const setPanelBackground = () => {
    while(bk_panel_image.firstChild){
        bk_panel_image.removeChild(bk_panel_image.firstChild);
    };

    if(panelBackgrounds.length > 0){
        shuffle(iPanelBackgrounds);

        bk_panel_image.appendChild(document.createTextNode(\`
            .split-view-view > .part.panel::after {

                background-image: url("\${panelBackgrounds[iPanelBackgrounds[0]].replace(/"/g, \`\\\\"\`)}");

            }
        \`));
    };
};

const shuffle = (arr) => {
    for(let i = arr.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * i);
        [arr[i], arr[j]] = [arr[j], arr[i]];
    };
};

document.getElementsByTagName("head")[0].appendChild(bk_global);
document.getElementsByTagName("head")[0].appendChild(bk_window_image);
document.getElementsByTagName("head")[0].appendChild(bk_editor_image);
document.getElementsByTagName("head")[0].appendChild(bk_sidebar_image);
document.getElementsByTagName("head")[0].appendChild(bk_panel_image);

for(const arr of [iWindowBackgrounds, iEditorBackgrounds, iSidebarBackgrounds, iPanelBackgrounds]){
    for(let i = arr.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    };
};

setWindowBackground();
setEditorBackground();
setSidebarBackground();
setPanelBackground();

if(windowTime > 0 && iWindowBackgrounds.length > 1){
    setInterval(() => {
        document.body.setAttribute("windowTransition", true);
        setTimeout(() => {
            setWindowBackground();
            document.body.setAttribute("windowTransition", false);
        }, 1 * 1000);
    }, windowTime * 1000);
};
if(editorTime > 0 && iEditorBackgrounds.length > 1){
    setInterval(() => {
        document.body.setAttribute("editorTransition", true);
        setTimeout(() => {
            setEditorBackground();
            document.body.setAttribute("editorTransition", false);
        }, 1 * 1000);
    }, editorTime * 1000);
};
if(sidebarTime > 0 && iSidebarBackgrounds.length > 1){
    setInterval(() => {
        document.body.setAttribute("sidebarTransition", true);
        setTimeout(() => {
            setSidebarBackground();
            document.body.setAttribute("sidebarTransition", false);
        }, 1 * 1000);
    }, sidebarTime * 1000);
};
if(panelTime > 0 && iPanelBackgrounds.length > 1){
    setInterval(() => {
        document.body.setAttribute("panelTransition", true);
        setTimeout(() => {
            setPanelBackground();
            document.body.setAttribute("panelTransition", false);
        }, 1 * 1000);
    }, panelTime * 1000);
};
})();`},No=i=>i.trim().replace(/\/\/ .*$/gm,"").replace(/\/\*.*?\*\//gms,"").replace(/^ +/gm,"").replace(/\r?\n/gm,"");var ht=(i,t)=>Array.isArray(i)?ht(i.length,t):`${i} ${t}${i!=1?"s":""}`,Fi=(i,t,e)=>i+(t(i)?e:""),ii=i=>`${(i[0]??"").toUpperCase()+(i??"").substring(1)}`;var ni=require("os"),W=require("vscode");var it=At("backgroundAlignment"),vt=i=>zt("backgroundAlignment",i,i.ui).then(()=>F(i.ui)),fn=i=>{let t=m("backgroundAlignment",{ui:i});q([w({label:it.items.enum[0],handle:vt,ui:i},t),w({label:it.items.enum[1],handle:vt,ui:i},t),w({label:it.items.enum[2],handle:vt,ui:i},t),j(),w({label:it.items.enum[3],handle:vt,ui:i},t),w({label:it.items.enum[4],handle:vt,ui:i},t),w({label:it.items.enum[5],handle:vt,ui:i},t),j(),w({label:it.items.enum[6],handle:vt,ui:i},t),w({label:it.items.enum[7],handle:vt,ui:i},t),w({label:it.items.enum[8],handle:vt,ui:i},t),j(),w({label:it.items.enum[9],description:`(${m("backgroundAlignmentValue",{ui:i})})`,ui:i,handle:e=>{let s=m("backgroundAlignmentValue",{ui:i});Z({title:M("Alignment",i),placeHolder:"Background position",value:s,prompt:`Background position (${s}). The literal value for the 'background-position' css property.`,validateInput:n=>bt(n)?null:"Invalid CSS",handle:n=>{if(bt(n)){let r=m("backgroundAlignment",{ui:i})!==it.items.enum[9]||s!==n;B("backgroundAlignment",it.items.enum[9],i,!0).then(()=>B("backgroundAlignmentValue",n,i,!0)).then(()=>{r&&oe(),F(i)})}}})}},t)],{title:M("Alignment",i),matchOnDescription:!0,placeHolder:"Background alignment"})};var pn=i=>{let t=m("backgroundBlur",{ui:i});Z({title:M("Blur",i),placeHolder:"Background blur",value:t,prompt:`Background blur (${t})`,validateInput:e=>bt(e)?null:"Invalid CSS",handle:e=>{bt(e)&&B("backgroundBlur",e,i).then(()=>F(i))}})};var mn=require("vscode");var gn=i=>{let t=N(m("backgroundOpacity",{ui:i}),2);Z({title:M("Opacity",i),placeHolder:"Background opacity",value:t.toString(),prompt:`Background opacity (${t}). ${m("useInvertedOpacity")?0:1} is fully visible and ${m("useInvertedOpacity")?1:0} is invisible.`,validateInput:e=>isNaN(+e)?"Not a number":+e<0||+e>1?"Opacity must be between 0 and 1":null,handle:e=>{if(!isNaN(+e)){let s=Math.min(Math.max(N(+e,2),0),1);(m("useInvertedOpacity")?s>.1:s<.9)?B("backgroundOpacity",s,i).then(()=>F(i)):mn.window.showWarningMessage("An opacity of "+s+" might make it difficult to see the UI, are you sure you want to use this opacity?",{modal:!0},"Yes").then(n=>{n==="Yes"&&B("backgroundOpacity",s,i).then(()=>F(i))})}}})};var st=At("backgroundRepeat"),Jt=i=>zt("backgroundRepeat",i,i.ui).then(()=>F(i.ui)),An=i=>{let t=m("backgroundRepeat",{ui:i});q([w({label:st.items.enum[0],description:st.items.enumDescriptions[0],handle:Jt,ui:i},t),w({label:st.items.enum[1],description:st.items.enumDescriptions[1],handle:Jt,ui:i},t),w({label:st.items.enum[2],description:st.items.enumDescriptions[2],handle:Jt,ui:i},t),w({label:st.items.enum[3],description:st.items.enumDescriptions[3],handle:Jt,ui:i},t),w({label:st.items.enum[4],description:st.items.enumDescriptions[4],handle:Jt,ui:i},t),w({label:st.items.enum[5],description:st.items.enumDescriptions[5],handle:Jt,ui:i},t)],{title:M("Repeat",i),matchOnDescription:!0,placeHolder:"Background repeat"})};var St=At("backgroundSize"),Ni=i=>zt("backgroundSize",i,i.ui).then(()=>F(i.ui)),bn=i=>{let t=m("backgroundSize",{ui:i});q([w({label:St.items.enum[0],description:St.items.enumDescriptions[0],handle:Ni,ui:i},t),w({label:St.items.enum[1],description:St.items.enumDescriptions[1],handle:Ni,ui:i},t),w({label:St.items.enum[2],description:St.items.enumDescriptions[2],handle:Ni,ui:i},t),j(),w({label:St.items.enum[3],description:`(${m("backgroundSizeValue",{ui:i})})`,ui:i,handle:e=>{let s=m("backgroundSizeValue",{ui:i});Z({title:M("Size",i),placeHolder:"Background size",value:s,prompt:`Background size (${s}). The literal value for the 'background-size' css property.`,validateInput:n=>bt(n)?null:"Invalid CSS",handle:n=>{if(bt(n)){let r=m("backgroundSize",{ui:i})!==St.items.enum[3]||s!==n;B("backgroundSize",St.items.enum[3],i,!0).then(()=>B("backgroundSizeValue",n,i,!0)).then(()=>{r&&oe(),F(i)})}}})}},t)],{title:M("Size",i),matchOnDescription:!0,placeHolder:"Background size"})};var wn=i=>{let t=N(m("backgroundChangeTime",{ui:i}),2);Z({title:M("Change Time",i),placeHolder:"Background change time",value:t.toString(),prompt:`Background change time (${t}). How long in seconds before the background should automatically change. Set to 0 to always use the same image.`,validateInput:e=>isNaN(+e)?"Not a number":+e<0?"Background change time must be a positive number":null,handle:e=>{if(!isNaN(+e)){let s=Math.max(N(+e,2),0);B("backgroundChangeTime",s,i).then(()=>F(i))}}})};var Uo=`https://github.com/KatsuteDev/Background/issues/new?template=bug.yml&os=${encodeURIComponent(`${(0,ni.platform)()} ${(0,ni.release)()}`)}&vs=${encodeURIComponent(W.version)}&version=${encodeURIComponent(ui.version)}`,Mo="https://github.com/KatsuteDev/Background/issues/new?template=feature.yml",ri=()=>q([si("window","window"),si("editor","multiple-windows"),si("sidebar","layout-sidebar-left"),si("panel","layout-panel"),j(),w({alwaysShow:!0,label:"$(check) Install",handle:()=>W.commands.executeCommand("background.install")}),w({alwaysShow:!0,label:"$(close) Uninstall",handle:()=>W.commands.executeCommand("background.uninstall")}),w({alwaysShow:!0,label:"$(refresh) Reload",handle:()=>W.commands.executeCommand("background.reload")}),w({label:"$(settings-gear) More Options",handle:()=>Ui()}),j(),w({label:"$(question) Help",handle:()=>W.commands.executeCommand("background.help")})],{title:"Background"+(Lt()===W.ConfigurationTarget.Workspace?" (Workspace)":""),matchOnDescription:!0}),Ui=i=>{let t=n=>`[$(${m(n)?"check":"close"})]`,e=(n,r,o)=>()=>B(n,!m(n),void 0,o).then(()=>Ui(r)),s=0;q([w({label:"Auto Install",description:t("autoInstall"),detail:"Automatically install background on startup or when VSCode updates",handle:e("autoInstall",s++,!0)}),w({label:"Render Content Above Background",description:t("renderContentAboveBackground"),detail:"Render content like images, PDFs, and markdown previews above the background",handle:e("renderContentAboveBackground",s++)}),w({label:"Use Inverted Opacity",description:t("useInvertedOpacity"),detail:"Use an inverted opacity, so 0 is fully visible and 1 is invisible",handle:e("useInvertedOpacity",s++)}),w({label:"Smooth Image Rendering",description:t("smoothImageRendering"),detail:"Use smooth image rendering rather than pixelated rendering when resizing images",handle:e("smoothImageRendering",s++)}),w({label:"Setting Scope",description:`[${m("settingScope")}]`,detail:"Where to save settings; workspace requires Auto Install to update background on switch",handle:()=>B("settingScope",m("settingScope")==="Global"?"Workspace":"Global").then(()=>Ui(s++))}),j(),w({label:"$(output) Changelog",handle:()=>W.commands.executeCommand("background.changelog")}),w({label:"$(bug) Report an issue",handle:()=>W.env.openExternal(`${Uo}&settings=${encodeURIComponent("```json\n"+JSON.stringify(dt(),null,4)+"\n```")}`)}),w({label:"$(add) Request a feature",handle:()=>W.env.openExternal(W.Uri.parse(Mo))})],{title:"More Options",matchOnDescription:!0,matchOnDetail:!0},()=>ri(),i)},si=(i,t)=>{let e=m(`${i}Backgrounds`),s=`${ht(e,"Glob")} (${ht(Yt(e),"Background")})`,n=`${m("backgroundAlignment",{ui:i})} Alignment \u2022 ${m("backgroundBlur",{ui:i})} Blur \u2022 ${m("backgroundOpacity",{ui:i})} Opacity \u2022 ${m("backgroundRepeat",{ui:i})} Repeat \u2022 ${m("backgroundSize",{ui:i})} Size`,r=+m("backgroundChangeTime",{ui:i});return r>0&&(n+=" \u2022 "+ht(r,"second")),w({label:`$(${t}) ${ii(i)}`,description:s,detail:n,ui:i,handle:()=>F(i)})},F=i=>q([w({label:"$(file-media) File",description:`${ht(m(`${i}Backgrounds`),"Glob")} (${ht(Yt(m(`${i}Backgrounds`)),"Background")})`,detail:"Select background image files",ui:i,handle:()=>Ce(i)}),j(),w({label:"$(arrow-both) Alignment",description:`${Fi(m("backgroundAlignment",{ui:i}),t=>t==="Manual",` (${m("backgroundAlignmentValue",{ui:i})})`)}`,detail:"Background image alignment",ui:i,handle:()=>fn(i)}),w({label:"$(eye) Blur",description:`${m("backgroundBlur",{ui:i})}`,detail:"Background image blur",ui:i,handle:()=>pn(i)}),w({label:"$(color-mode) Opacity",description:`${m("backgroundOpacity",{ui:i})}`,detail:"Background image opacity",ui:i,handle:()=>gn(i)}),w({label:"$(multiple-windows) Repeat",description:`${m("backgroundRepeat",{ui:i})}`,detail:"Background image repeat",ui:i,handle:()=>An(i)}),w({label:"$(screen-full) Size",description:`${Fi(m("backgroundSize",{ui:i}),t=>t==="Manual",` (${m("backgroundSizeValue",{ui:i})})`)}`,detail:"Background image size",ui:i,handle:()=>bn(i)}),w({label:"$(clock) Time",description:`${ht(+m("backgroundChangeTime",{ui:i}),"second")}`,detail:"How often to change the background",ui:i,handle:()=>wn(i)})],{title:`${ii(i)} Background`+(Lt()===W.ConfigurationTarget.Workspace?" (Workspace)":""),matchOnDescription:!0,matchOnDetail:!0},ri),M=(i,t)=>(t?`${ii(t)} `:"")+`Background - ${i}`;var Ut=i=>m(`${i}Backgrounds`),te=async(i,t,e=!1)=>{let s=Ut(i);s.push(...Array.isArray(t)?t:[t]),await B(`${i}Backgrounds`,s.filter(et),void 0,e),e||Ce(i)},Mi=async(i,t,e,s=!1)=>{let n=Ut(i).filter(et);for(let r=0,o=n.length;r<o;r++)if(n[r]===t){n[r]=e;break}await B(`${i}Backgrounds`,n.filter(et),void 0,s||t===e),s||Ce(i)},oi=async(i,t,e=!1)=>{let s=Array.isArray(t)?t:[t];await B(`${i}Backgrounds`,Ut(i).filter(n=>!s.includes(n)).filter(et),void 0,e),e||Ce(i)},Ce=i=>{let t=Ut(i).filter(et).map(e=>w({label:e.replace(/(\$\(\w+\))/g,"\\$1"),value:e,ui:i,description:`${ht(Yt(e),"matching file")}`,handle:s=>Z({title:`Update ${s.value}`,placeHolder:"File path, glob, or URL; leave blank to remove",value:s.value??"",prompt:"Use only '/' for directories, '\\' is reserved for escape characters. Leave this field blank to remove.",validateInput:n=>n.startsWith("file://")?"Do not include 'file://' as part of the file path":n.startsWith("http://")?"Images must be served over HTTPS":null,handle:n=>{n.trim().length===0?oi(i,s.value):Mi(i,s.value,n)}})}));q([...t,j(),w({alwaysShow:!0,label:"$(file-add) Add a File",ui:i,handle:e=>Kt.window.showOpenDialog({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!0,openLabel:"Select Image",filters:{Images:ei()}}).then(s=>s&&te(i,s.map(n=>Di(n))))}),w({alwaysShow:!0,label:"$(file-directory-create) Add a Folder",ui:i,handle:e=>Kt.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!0,openLabel:"Select Folder"}).then(s=>s&&te(i,s.map(n=>`${Di(n)}/**`)))}),w({alwaysShow:!0,label:"$(kebab-horizontal) Add a Glob",ui:i,handle:e=>Kt.window.showInputBox({title:"Add Glob",placeHolder:"File path or glob",prompt:"Add a file or a glob. Use only '/' for directories, '\\' is reserved for escape characters.",validateInput:s=>s.startsWith("file://")?"Do not include 'file://' as part of the file path":s.startsWith("http://")||s.startsWith("https://")?"Image URLs do not support glob, use Add URL option":null}).then(s=>{s&&te(i,s)})}),w({alwaysShow:!0,label:"$(ports-open-browser-icon) Add a URL",ui:i,handle:e=>Kt.window.showInputBox({title:"Add URL",placeHolder:"Image URL",prompt:"Add a image URL. Must be served over HTTPS",validateInput:s=>s.startsWith("file://")?"File URLs not accepted, use Add File option":s.startsWith("http://")?"Images must be served over HTTPS":s.startsWith("https://")?null:"Invalid URL"}).then(s=>{s&&te(i,s)})}),...t.length>0?[j(),w({alwaysShow:!0,label:"$(trash) Delete a Background",ui:i,handle:e=>{let s=Ut(i).filter(et).map(n=>{let r=Yt(n);return w({label:n.replace(/(\$\(\w+\))/g,"\\$1"),value:n,ui:e.ui,description:`${ht(r,"matching file")}`})});Kt.window.showQuickPick(s,{title:M("Delete",i),placeHolder:"Files",canPickMany:!0}).then(n=>n&&oi(i,n.map(r=>r.value)))}})]:[]],{title:M("Files",i),placeHolder:"Files"},()=>F(i))};var kn={install:()=>Li.commands.executeCommand("background.install"),uninstall:()=>Li.commands.executeCommand("background.uninstall"),reload:Pt,get:i=>{switch(i){case"window":case"editor":case"sidebar":case"panel":return Ut(i);default:return}},add:async(i,t)=>{switch(i){case"window":case"editor":case"sidebar":case"panel":return await te(i,t,!0),!0;default:return!1}},replace:async(i,t,e)=>{switch(i){case"window":case"editor":case"sidebar":case"panel":return await Mi(i,t,e,!0),!0;default:return!1}},remove:async(i,t)=>{switch(i){case"window":case"editor":case"sidebar":case"panel":return await oi(i,t,!0),!0;default:return!1}}};var Xi=Mt(Un()),li=require("vscode"),Be=require("os"),Mn=Mt(hi()),ut=require("fs");var Hi=(i,t,e=!1)=>{zn(i,t,dn((0,ut.readFileSync)(i,"utf-8")),e)},Ln=(i,t,e=!1)=>{zn(i,t,Pi((0,ut.readFileSync)(i,"utf-8")),e)},ta=/(?<=^\s*"vs\/workbench\/workbench\.desktop\.main\.js\": \").*(?=\",\s*$)/gm,zn=(i,t,e,s=!1)=>{let n=(0,ut.readFileSync)(t,"utf-8").replace(ta,ss(e));try{se(!0);let r=s;(0,ut.readFileSync)(i,"utf-8")!==e&&((0,ut.writeFileSync)(i,e,"utf-8"),r=!0),(0,ut.readFileSync)(t,"utf-8")!==n&&((0,ut.writeFileSync)(t,n,"utf-8"),r=!0),r?setTimeout(Pt,Te):se(!1)}catch(r){(0,Be.platform)()==="linux"&&i.toString().replace(/\\/g,"/").includes("/snap/")&&t.toString().replace(/\\/g,"/").includes("/snap/")?li.window.showErrorMessage("Background extension does not support snap installations, use deb or rpm"):li.window.showWarningMessage("Failed to write changes, run command as administrator?",{detail:`The Background extension does not have permission to write changes, run command using administrator permissions?

${r.message}`,modal:!0},"Yes").then(a=>{if(a==="Yes"){let l=(0,Xi.fileSync)().name;(0,ut.writeFileSync)(l,e,"utf-8");let c=(0,Xi.fileSync)().name;(0,ut.writeFileSync)(c,n,"utf-8");let h=Pe([[l,i],[c,t]]);(0,Mn.exec)(h,{name:"VSCode Extension Host"},u=>{u?(li.window.showErrorMessage("Failed to write changes",{detail:`OS: ${(0,Be.platform)()} ${(0,Be.release)()}
Using command: ${h}

${u.name}
${u.message}`.trim(),modal:!0}),se(!1)):Pt()})}else se(!1)})}};var jn=require("vscode");var ea=1e3,Te=7e3,se=i=>{ci.text=`$(${i===!1?"file-media":"loading~spin"}) Background`},ci=(()=>{let i=E.window.createStatusBarItem(E.StatusBarAlignment.Right);return i.command="background.config",i.name="Background",i.text="$(file-media) Background",i.tooltip="Open background configuration",i})(),ia=i=>{let t,e,s=jn.env.appRoot;if(ln((0,ne.join)(i.globalStorageUri.fsPath,"../../../User")),s)if(t=(0,ne.join)(s,"out","vs","workbench","workbench.desktop.main.js"),e=(0,ne.join)(s,"product.json"),(0,Rt.existsSync)(t))if((0,Rt.existsSync)(e)){let o=t.replace(".js","-backup.js"),a=e.replace(".json","-backup.json");if(!(0,Rt.existsSync)(o)||!(0,Rt.existsSync)(a))try{(0,Rt.copyFileSync)(t,o),(0,Rt.copyFileSync)(e,a)}catch(l){if((0,Ie.platform)()==="linux"&&t.toString().replace(/\\/g,"/").includes("/snap/")&&e.toString().replace(/\\/g,"/").includes("/snap/")){E.window.showErrorMessage("Background extension does not support snap installations, use deb or rpm");return}else E.window.showWarningMessage("Failed to backup files, run command as administrator?",{detail:`The Background extension does not have permission to backup to the VSCode folder, run command using administrator permissions?

${l.message}`,modal:!0},"Yes").then(h=>{if(h==="Yes"){let u=Pe([[t,o],[e,a]]);(0,Wn.exec)(u,{name:"VSCode Extension Host"},d=>{d&&E.window.showErrorMessage("Failed to backup files",{detail:`OS: ${(0,Ie.platform)()} ${(0,Ie.release)()}
Using command: ${u}

${d.name}
${d.message}`.trim(),modal:!0})})}else E.window.showWarningMessage("Background extension is running without backup files")})}}else{E.window.showErrorMessage(`Failed to find '${e}', please report this issue`);return}else{E.window.showErrorMessage(`Failed to find '${t}', please report this issue`);return}else{E.window.showErrorMessage("Failed to find application directory, please report this issue");return}let n=E.Uri.file((0,ne.join)(i.extensionPath,"CHANGELOG.md")),r=E.Uri.file((0,ne.join)(i.extensionPath,"HELP.md"));i.subscriptions.push(E.commands.registerCommand("background.install",()=>Hi(t,e,!0)),E.commands.registerCommand("background.uninstall",()=>dt().update("autoInstall",!1,E.ConfigurationTarget.Global).then(()=>Ln(t,e,!0))),E.commands.registerCommand("background.reload",Pt),E.commands.registerCommand("background.help",()=>E.commands.executeCommand("markdown.showPreview",r)),E.commands.registerCommand("background.changelog",()=>E.commands.executeCommand("markdown.showPreview",n)),E.commands.registerCommand("background.config",ri),ci),ci.show(),dt().has("useInvertedOpacity")||E.commands.executeCommand("workbench.action.reloadWindow"),i.globalState.get("migratedOpacity")!==!0&&(m("backgroundOpacity",{scope:"global",includeDefault:!1})?B("useInvertedOpacity",!0,void 0,!0).then(()=>i.globalState.update("migratedOpacity",!0)).then(()=>E.window.showInformationMessage("Background opacity settings have been migrated to the latest version.")):i.globalState.update("migratedOpacity",!0)),dt().get("autoInstall")&&Hi(t,e,!1);for(let o=Te;o>ea;o-=1e3)setTimeout(()=>Te-=1e3,o);return kn};0&&(module.exports={activate,installDelay,setActive,statusbar});
